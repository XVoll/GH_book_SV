<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 7 Stepwise Covariates Selection | High-resolution spatial modelling of population welfare in El Salvador, Phase II</title>
  <meta name="description" content="This is report provides a tutorial to conduct proof-of-concept high-resolution maps of poverty, average income and literacy. The emphasis is put on providing replicable code exemples." />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 7 Stepwise Covariates Selection | High-resolution spatial modelling of population welfare in El Salvador, Phase II" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is report provides a tutorial to conduct proof-of-concept high-resolution maps of poverty, average income and literacy. The emphasis is put on providing replicable code exemples." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 7 Stepwise Covariates Selection | High-resolution spatial modelling of population welfare in El Salvador, Phase II" />
  
  <meta name="twitter:description" content="This is report provides a tutorial to conduct proof-of-concept high-resolution maps of poverty, average income and literacy. The emphasis is put on providing replicable code exemples." />
  

<meta name="author" content="Xavier Vollenweider, Claudio Bosco" />


<meta name="date" content="2019-12-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simple-model.html"/>
<link rel="next" href="summary-of-resuls.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Table of Content</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequesite</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#overview"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#first-look-at-the-data"><i class="fa fa-check"></i><b>2.2</b> First look at the data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Data Pre-processing</a><ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#sources"><i class="fa fa-check"></i><b>3.1</b> Data sources</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#loading-the-survey"><i class="fa fa-check"></i><b>3.2</b> Loading the survey</a></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#loading-the-vectors"><i class="fa fa-check"></i><b>3.3</b> Loading the vectors</a><ul>
<li class="chapter" data-level="3.3.1" data-path="data.html"><a href="data.html#loading-the-administrative-boundaries"><i class="fa fa-check"></i><b>3.3.1</b> Loading the administrative boundaries</a></li>
<li class="chapter" data-level="3.3.2" data-path="data.html"><a href="data.html#loading-the-shapefiles-containing-fields-used-as-covariates"><i class="fa fa-check"></i><b>3.3.2</b> Loading the shapefiles containing fields used as covariates</a></li>
<li class="chapter" data-level="3.3.3" data-path="data.html"><a href="data.html#loading-point-referenced-data-from-tables"><i class="fa fa-check"></i><b>3.3.3</b> Loading point-referenced data from tables</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data.html"><a href="data.html#loading-the-rasters"><i class="fa fa-check"></i><b>3.4</b> Loading the rasters</a><ul>
<li class="chapter" data-level="3.4.1" data-path="data.html"><a href="data.html#lights-at-night"><i class="fa fa-check"></i><b>3.4.1</b> Lights at night</a></li>
<li class="chapter" data-level="3.4.2" data-path="data.html"><a href="data.html#precipitation"><i class="fa fa-check"></i><b>3.4.2</b> Precipitation</a></li>
<li class="chapter" data-level="3.4.3" data-path="data.html"><a href="data.html#soil-degradation"><i class="fa fa-check"></i><b>3.4.3</b> Soil degradation</a></li>
<li class="chapter" data-level="3.4.4" data-path="data.html"><a href="data.html#vegetation-greenness"><i class="fa fa-check"></i><b>3.4.4</b> Vegetation greenness</a></li>
<li class="chapter" data-level="3.4.5" data-path="data.html"><a href="data.html#temperature"><i class="fa fa-check"></i><b>3.4.5</b> Temperature</a></li>
<li class="chapter" data-level="3.4.6" data-path="data.html"><a href="data.html#slope"><i class="fa fa-check"></i><b>3.4.6</b> Slope</a></li>
<li class="chapter" data-level="3.4.7" data-path="data.html"><a href="data.html#other-rasters"><i class="fa fa-check"></i><b>3.4.7</b> Other rasters</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data.html"><a href="data.html#rasters-calculation"><i class="fa fa-check"></i><b>3.5</b> Rasters calculation</a><ul>
<li class="chapter" data-level="3.5.1" data-path="data.html"><a href="data.html#lights-at-night-1"><i class="fa fa-check"></i><b>3.5.1</b> Lights at night</a></li>
<li class="chapter" data-level="3.5.2" data-path="data.html"><a href="data.html#precipitation-1"><i class="fa fa-check"></i><b>3.5.2</b> Precipitation</a></li>
<li class="chapter" data-level="3.5.3" data-path="data.html"><a href="data.html#vegetation-greenness-1"><i class="fa fa-check"></i><b>3.5.3</b> Vegetation greenness</a></li>
<li class="chapter" data-level="3.5.4" data-path="data.html"><a href="data.html#soil-degradation-1"><i class="fa fa-check"></i><b>3.5.4</b> Soil degradation</a></li>
<li class="chapter" data-level="3.5.5" data-path="data.html"><a href="data.html#temperature-1"><i class="fa fa-check"></i><b>3.5.5</b> Temperature</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data.html"><a href="data.html#distance-calculation"><i class="fa fa-check"></i><b>3.6</b> Distance calculation</a><ul>
<li class="chapter" data-level="3.6.1" data-path="data.html"><a href="data.html#distance-to-public-services"><i class="fa fa-check"></i><b>3.6.1</b> Distance to public services</a></li>
<li class="chapter" data-level="3.6.2" data-path="data.html"><a href="data.html#distance-to-businesses"><i class="fa fa-check"></i><b>3.6.2</b> Distance to businesses</a></li>
<li class="chapter" data-level="3.6.3" data-path="data.html"><a href="data.html#distance-to-natural-features"><i class="fa fa-check"></i><b>3.6.3</b> Distance to natural features</a></li>
<li class="chapter" data-level="3.6.4" data-path="data.html"><a href="data.html#stack-distance-maps-and-inspect-results"><i class="fa fa-check"></i><b>3.6.4</b> Stack distance maps and inspect results</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data.html"><a href="data.html#spatial-statistics-at-segmento-level"><i class="fa fa-check"></i><b>3.7</b> Spatial statistics at <em>segmento</em> level</a><ul>
<li class="chapter" data-level="3.7.1" data-path="data.html"><a href="data.html#adjusting-the-coordinates-reference-system-for-raster-extaction-to-segmento"><i class="fa fa-check"></i><b>3.7.1</b> Adjusting the Coordinates Reference System for raster extaction to <em>segmento</em></a></li>
<li class="chapter" data-level="3.7.2" data-path="data.html"><a href="data.html#rasters"><i class="fa fa-check"></i><b>3.7.2</b> Rasters</a></li>
<li class="chapter" data-level="3.7.3" data-path="data.html"><a href="data.html#vectors"><i class="fa fa-check"></i><b>3.7.3</b> Vectors</a></li>
<li class="chapter" data-level="3.7.4" data-path="data.html"><a href="data.html#population-density"><i class="fa fa-check"></i><b>3.7.4</b> Population density</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="data.html"><a href="data.html#merging-the-covariates-with-the-ehpm-data"><i class="fa fa-check"></i><b>3.8</b> Merging the covariates with the EHPM data</a></li>
<li class="chapter" data-level="3.9" data-path="data.html"><a href="data.html#summary"><i class="fa fa-check"></i><b>3.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="explo.html"><a href="explo.html"><i class="fa fa-check"></i><b>4</b> Data exploration and preselection of covariates</a><ul>
<li class="chapter" data-level="4.1" data-path="explo.html"><a href="explo.html#outcome-variabes-distribution-and-outliers"><i class="fa fa-check"></i><b>4.1</b> Outcome variabes: distribution and outliers</a><ul>
<li class="chapter" data-level="4.1.1" data-path="explo.html"><a href="explo.html#income"><i class="fa fa-check"></i><b>4.1.1</b> Income</a></li>
<li class="chapter" data-level="4.1.2" data-path="explo.html"><a href="explo.html#literacy"><i class="fa fa-check"></i><b>4.1.2</b> Literacy</a></li>
<li class="chapter" data-level="4.1.3" data-path="explo.html"><a href="explo.html#moderate-poverty"><i class="fa fa-check"></i><b>4.1.3</b> Moderate Poverty</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="explo.html"><a href="explo.html#unsupervised-dimension-reduction-based-on-distance-correlation"><i class="fa fa-check"></i><b>4.2</b> Unsupervised dimension reduction based on distance correlation</a><ul>
<li class="chapter" data-level="4.2.1" data-path="explo.html"><a href="explo.html#obtaining-a-dataframe-with-standardized-covariates"><i class="fa fa-check"></i><b>4.2.1</b> Obtaining a dataframe with standardized covariates</a></li>
<li class="chapter" data-level="4.2.2" data-path="explo.html"><a href="explo.html#unsupervised-dimension-reduction-based-on-distance-correlation-1"><i class="fa fa-check"></i><b>4.2.2</b> Unsupervised dimension reduction based on distance correlation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="explo.html"><a href="explo.html#correlations-between-predictors"><i class="fa fa-check"></i><b>4.3</b> Correlations between predictors</a><ul>
<li class="chapter" data-level="4.3.1" data-path="explo.html"><a href="explo.html#correlation-with-income"><i class="fa fa-check"></i><b>4.3.1</b> Correlation with income</a></li>
<li class="chapter" data-level="4.3.2" data-path="explo.html"><a href="explo.html#correlation-with-literacy"><i class="fa fa-check"></i><b>4.3.2</b> Correlation with literacy</a></li>
<li class="chapter" data-level="4.3.3" data-path="explo.html"><a href="explo.html#correlation-with-poverty"><i class="fa fa-check"></i><b>4.3.3</b> Correlation with poverty</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="theory.html"><a href="theory.html"><i class="fa fa-check"></i><b>5</b> Primer on INLA</a><ul>
<li class="chapter" data-level="5.1" data-path="theory.html"><a href="theory.html#area-data-vs-point-referenced-data"><i class="fa fa-check"></i><b>5.1</b> Area data vs point-referenced data</a><ul>
<li class="chapter" data-level="5.1.1" data-path="theory.html"><a href="theory.html#bayesian-approach"><i class="fa fa-check"></i><b>5.1.1</b> Bayesian approach</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="theory.html"><a href="theory.html#model-formulation"><i class="fa fa-check"></i><b>5.2</b> Model formulation</a><ul>
<li class="chapter" data-level="5.2.1" data-path="theory.html"><a href="theory.html#a-simple-model-not-accounting-for-spatial-dependence"><i class="fa fa-check"></i><b>5.2.1</b> A simple model not accounting for spatial dependence</a></li>
<li class="chapter" data-level="5.2.2" data-path="theory.html"><a href="theory.html#a-spatial-model"><i class="fa fa-check"></i><b>5.2.2</b> A spatial model</a></li>
<li class="chapter" data-level="5.2.3" data-path="theory.html"><a href="theory.html#estimating-the-model-with-aeral-data"><i class="fa fa-check"></i><b>5.2.3</b> Estimating the model with aeral data</a></li>
<li class="chapter" data-level="5.2.4" data-path="theory.html"><a href="theory.html#estimating-the-model-with-point-referenced-data"><i class="fa fa-check"></i><b>5.2.4</b> Estimating the model with point-referenced data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="simple-model.html"><a href="simple-model.html"><i class="fa fa-check"></i><b>6</b> Fitting a simple model</a><ul>
<li class="chapter" data-level="6.1" data-path="simple-model.html"><a href="simple-model.html#loading-the-data"><i class="fa fa-check"></i><b>6.1</b> Loading the data</a></li>
<li class="chapter" data-level="6.2" data-path="simple-model.html"><a href="simple-model.html#area-data"><i class="fa fa-check"></i><b>6.2</b> Area data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="simple-model.html"><a href="simple-model.html#spatial-dependency-with-area-data-data"><i class="fa fa-check"></i><b>6.2.1</b> Spatial dependency with <em>area data</em> data</a></li>
<li class="chapter" data-level="6.2.2" data-path="simple-model.html"><a href="simple-model.html#store-the-data-for-modelling"><i class="fa fa-check"></i><b>6.2.2</b> Store the data for modelling</a></li>
<li class="chapter" data-level="6.2.3" data-path="simple-model.html"><a href="simple-model.html#split-the-sample-into-a-8020-training-and-validation-sets"><i class="fa fa-check"></i><b>6.2.3</b> Split the sample into a 80/20 training and validation sets</a></li>
<li class="chapter" data-level="6.2.4" data-path="simple-model.html"><a href="simple-model.html#formula-specifying-the-relationship-between-the-outcome-variable-and-the-fixed-and-spatial-random-effects"><i class="fa fa-check"></i><b>6.2.4</b> Formula specifying the relationship between the outcome variable and the fixed and spatial random effects</a></li>
<li class="chapter" data-level="6.2.5" data-path="simple-model.html"><a href="simple-model.html#fit-the-model-on-the-training-set"><i class="fa fa-check"></i><b>6.2.5</b> Fit the model on the training set</a></li>
<li class="chapter" data-level="6.2.6" data-path="simple-model.html"><a href="simple-model.html#validate-the-model-on-the-validation-set"><i class="fa fa-check"></i><b>6.2.6</b> Validate the model on the validation set</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="simple-model.html"><a href="simple-model.html#point-referenced-data"><i class="fa fa-check"></i><b>6.3</b> Point-referenced data</a><ul>
<li class="chapter" data-level="6.3.1" data-path="simple-model.html"><a href="simple-model.html#spatial-dependency-with-point-referenced-data-data"><i class="fa fa-check"></i><b>6.3.1</b> Spatial dependency with <em>point-referenced data</em> data</a></li>
<li class="chapter" data-level="6.3.2" data-path="simple-model.html"><a href="simple-model.html#store-the-data-for-modelling-in-a-stack"><i class="fa fa-check"></i><b>6.3.2</b> Store the data for modelling in a stack</a></li>
<li class="chapter" data-level="6.3.3" data-path="simple-model.html"><a href="simple-model.html#formula-specifying-the-relationship-between-the-outcome-variable-and-the-fixed-and-spatial-random-effects-1"><i class="fa fa-check"></i><b>6.3.3</b> Formula specifying the relationship between the outcome variable and the fixed and spatial random effects</a></li>
<li class="chapter" data-level="6.3.4" data-path="simple-model.html"><a href="simple-model.html#fit-the-model-on-the-training-set-1"><i class="fa fa-check"></i><b>6.3.4</b> Fit the model on the training set</a></li>
<li class="chapter" data-level="6.3.5" data-path="simple-model.html"><a href="simple-model.html#validate-the-model-on-the-validation-set-1"><i class="fa fa-check"></i><b>6.3.5</b> Validate the model on the validation set</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="simple-model.html"><a href="simple-model.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>6.4</b> <em>K-fold</em> cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="stepwise.html"><a href="stepwise.html"><i class="fa fa-check"></i><b>7</b> Stepwise Covariates Selection</a><ul>
<li class="chapter" data-level="7.1" data-path="stepwise.html"><a href="stepwise.html#step-1-split-the-sample-into-a-602020-training-validation-and-test-sets"><i class="fa fa-check"></i><b>7.1</b> Step 1: Split the sample into a 60/20/20 training, validation and test sets</a></li>
<li class="chapter" data-level="7.2" data-path="stepwise.html"><a href="stepwise.html#bundle-step-2-to-4-in-a-function"><i class="fa fa-check"></i><b>7.2</b> Bundle step 2 to 4 in a function</a></li>
<li class="chapter" data-level="7.3" data-path="stepwise.html"><a href="stepwise.html#bundle-step-5-to-7-in-a-loop-ran-in-parallel"><i class="fa fa-check"></i><b>7.3</b> Bundle step 5 to 7 in a loop ran in parallel</a></li>
<li class="chapter" data-level="7.4" data-path="stepwise.html"><a href="stepwise.html#step-8-inspect-the-results-and-select-specification"><i class="fa fa-check"></i><b>7.4</b> Step 8: Inspect the results and select specification</a></li>
<li class="chapter" data-level="7.5" data-path="stepwise.html"><a href="stepwise.html#step-9-final-test"><i class="fa fa-check"></i><b>7.5</b> Step 9 Final test</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="summary-of-resuls.html"><a href="summary-of-resuls.html"><i class="fa fa-check"></i><b>8</b> Results summary</a><ul>
<li class="chapter" data-level="8.1" data-path="summary-of-resuls.html"><a href="summary-of-resuls.html#goodness-of-fit-at-the-segmento-level"><i class="fa fa-check"></i><b>8.1</b> Goodness of fit at the <em>segmento</em> level</a></li>
<li class="chapter" data-level="8.2" data-path="summary-of-resuls.html"><a href="summary-of-resuls.html#segmento-level-map"><i class="fa fa-check"></i><b>8.2</b> <em>Segmento</em> level map</a></li>
<li class="chapter" data-level="8.3" data-path="summary-of-resuls.html"><a href="summary-of-resuls.html#goodness-of-fit-at-the-municipio-level"><i class="fa fa-check"></i><b>8.3</b> Goodness of fit at the <em>Municipio</em> level</a><ul>
<li class="chapter" data-level="8.3.1" data-path="summary-of-resuls.html"><a href="summary-of-resuls.html#aggregating-results-at-the-municipio-level-using-all-segmentos"><i class="fa fa-check"></i><b>8.3.1</b> Aggregating results at the municipio level using all <em>segmentos</em></a></li>
<li class="chapter" data-level="8.3.2" data-path="summary-of-resuls.html"><a href="summary-of-resuls.html#aggregating-results-at-the-municipio-level-using-only-segmentos-in-representative-municipios"><i class="fa fa-check"></i><b>8.3.2</b> Aggregating results at the municipio level using only <em>segmentos</em> in representative municipios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="theory.html"><a href="theory.html#theory"><i class="fa fa-check"></i><b>9</b> Primer on INLA</a><ul>
<li class="chapter" data-level="9.1" data-path="theory.html"><a href="theory.html#area-data-vs-point-referenced-data-1"><i class="fa fa-check"></i><b>9.1</b> Area data vs point-referenced data</a><ul>
<li class="chapter" data-level="9.1.1" data-path="theory.html"><a href="theory.html#bayesian-approach-1"><i class="fa fa-check"></i><b>9.1.1</b> Bayesian approach</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="theory.html"><a href="theory.html#model-formulation-1"><i class="fa fa-check"></i><b>9.2</b> Model formulation</a><ul>
<li class="chapter" data-level="9.2.1" data-path="theory.html"><a href="theory.html#a-simple-model-not-accounting-for-spatial-dependence-1"><i class="fa fa-check"></i><b>9.2.1</b> A simple model not accounting for spatial dependence</a></li>
<li class="chapter" data-level="9.2.2" data-path="theory.html"><a href="theory.html#a-spatial-model-1"><i class="fa fa-check"></i><b>9.2.2</b> A spatial model</a></li>
<li class="chapter" data-level="9.2.3" data-path="theory.html"><a href="theory.html#estimating-the-model-with-aeral-data-1"><i class="fa fa-check"></i><b>9.2.3</b> Estimating the model with aeral data</a></li>
<li class="chapter" data-level="9.2.4" data-path="theory.html"><a href="theory.html#estimating-the-model-with-point-referenced-data-1"><i class="fa fa-check"></i><b>9.2.4</b> Estimating the model with point-referenced data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="http://flowminder.org/" target="blank">Released by Flowminder Foundation</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">High-resolution spatial modelling of population welfare in El Salvador, Phase II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="stepwise" class="section level1">
<h1><span class="header-section-number">Section 7</span> Stepwise Covariates Selection</h1>
<p>The goal of this section is to describe a backward stepwise covariates selection process, i.e. a process to reduce the number of covariates from the 50 potential ones identified in section <a href="explo.html#explo">4</a> to circa 10 or less. Here is an overview of the process:</p>
<ol style="list-style-type: decimal">
<li>Split the sample into a 60/20/20 training, validation and test sets;<br />
</li>
<li>Write the test formula without one of the 50 candidate covariates;</li>
<li>Fit the model on the training set;</li>
<li>Validate the model on the validation set and compute goodness of fit statistics;</li>
<li>Repeat step 2 to 4 once for each covariate (50 times);</li>
<li>Drop the covariate in the absence of which the fit us the best;</li>
<li>Repeat steps 2 to 6 until no covariate is left;</li>
<li>Inspect the result to identify a parsimonious specification (typically below 10 covariates) yielding a good fit on the validation set;</li>
<li>Test the final model on the test set.</li>
</ol>
<p>The backward stepwise covariates selection process is computationally expensive. Fitting one modified BYM model takes around 3.5 minutes on a standard PC<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. To carry steps 1 to 5, it takes approximately 175 minutes. Step 6 to 7 takes hence approximately 74 hours. In order to speed it up the process, we write a function to parallelise step 5 across CPU cores. As the number of cores might relatively limited on a PC (typically below 8), an option is to carry the process on the cloud where an instance with more cores can be rented. For instance, the computing time can be reduced to below two hours with 64 cores.</p>
<p>The backward stepwise covariates selection is presented with the income model.</p>
<div id="step-1-split-the-sample-into-a-602020-training-validation-and-test-sets" class="section level2">
<h2><span class="header-section-number">7.1</span> Step 1: Split the sample into a 60/20/20 training, validation and test sets</h2>
<p>The observations in the dataset are split into a 60/20/20 training, validation and test sets. The model will be fitted on the training set. Income will be predicted on the training and validation sets. Predicted values in the validation set will be compared with the observed values in order to assess the goodness of it of the model.</p>
<p>Once the covariate selection process is complete and a given specification has been chosen (steps 1 to 8 above), prediction are made on the final test set to assess the goodness of fit of the final model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># sample segmentos for training, validation and test  ####</span>
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
spec =<span class="st"> </span><span class="kw">c</span>(<span class="dt">train =</span> .<span class="dv">6</span>, <span class="dt">test =</span> .<span class="dv">2</span>, <span class="dt">validate =</span> .<span class="dv">2</span>)
g =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">cut</span>(
  <span class="kw">seq</span>(<span class="kw">nrow</span>(data_model)), 
  <span class="kw">nrow</span>(data_model)<span class="op">*</span><span class="kw">cumsum</span>(<span class="kw">c</span>(<span class="dv">0</span>,spec)),
  <span class="dt">labels =</span> <span class="kw">names</span>(spec)
))
index_val=<span class="kw">which</span>(g<span class="op">==</span><span class="st">&quot;validate&quot;</span>)
index_train=<span class="kw">which</span>(g<span class="op">==</span><span class="st">&quot;train&quot;</span>)
index_test=<span class="kw">which</span>(g<span class="op">==</span><span class="st">&quot;test&quot;</span>)

data_model<span class="op">$</span>pred=data_model<span class="op">$</span>ingpe
data_model<span class="op">$</span>pred[<span class="kw">c</span>(index_val,index_test)] &lt;-<span class="st"> </span><span class="ot">NA</span> <span class="co"># set the validation pred to NA: they will be predicted by the model and compared with observed values </span>

mod_data_jack =<span class="st"> </span>data_model <span class="co"># store data into a new dataframe for model fitting      </span>
mod_data_jack=mod_data_jack[<span class="kw">c</span>(index_val,index_train),] <span class="co"># select only the training and validation sets, keep test set of final validation</span>
index_val_jack=<span class="kw">which</span>(<span class="kw">is.na</span>(mod_data_jack<span class="op">$</span>pred))
index_train_jack=<span class="kw">which</span>(<span class="kw">is.na</span>(mod_data_jack<span class="op">$</span>pred)<span class="op">==</span>F)</code></pre></div>
</div>
<div id="bundle-step-2-to-4-in-a-function" class="section level2">
<h2><span class="header-section-number">7.2</span> Bundle step 2 to 4 in a function</h2>
<p>In order to ease the reading of the code, we create a function <code>INLA_steps_2_4</code> implementing steps 2 to 4 of the covariate selection process. The <code>INLA_steps_2_4</code>:</p>
<ol style="list-style-type: decimal">
<li>Write the test formula without one of the candidate covariates;</li>
<li>Fit the model on the training set;</li>
<li>Validate the model on the validation set;</li>
<li>Compute goodness of fit statistics.</li>
</ol>
<p>The <code>INLA_steps_2_4</code> accepts the following arguments: - covariates formulation - index of the covariate to be removed - index of the validation set - index of the training set - dataframe for the model - a string defining the outcome variable, e.g. “ingpe” - a string defining the likelihood function, e.g. Gaussian, Gamma or a Beta distribution</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># INLA_set2_4_function #####</span>
INLA_steps_2_<span class="dv">4</span>=<span class="cf">function</span>(covariates_formulation, <span class="co"># formulation of each covariate</span>
                        ix, <span class="co"># the index of the covariate to be removed</span>
                        index_val, <span class="co"># index of the validation set</span>
                        index_train, <span class="co"># index of the training set</span>
                        mod_data_jack, <span class="co"># data for the model</span>
                        outcome,   <span class="co"># string defining the outcome variable, e.g. ingpe</span>
                        family){   <span class="co"># string defining the likelihood </span>
  
  <span class="co"># formula</span>
  candidate_covariates &lt;-<span class="st"> </span>covariates_formulation 
  
  formula_test &lt;-<span class="st"> </span><span class="kw">reformulate</span>(<span class="kw">c</span>(<span class="st">&quot;-1&quot;</span>, <span class="st">&quot;intercept&quot;</span>,
                                <span class="kw">paste</span>(candidate_covariates[<span class="op">-</span>ix],<span class="dt">collapse=</span><span class="st">&quot;+&quot;</span>),
                                <span class="st">&#39;f(ID,model = &quot;bym2&quot;,</span>
<span class="st">                                hyper=list(</span>
<span class="st">                                prec = list(prior = &quot;pc.prec&quot;, param = c(0.1, 0.0001)),</span>
<span class="st">                                phi  = list(prior = &quot;pc&quot;, param = c(0.5, 0.5))),</span>
<span class="st">                                graph = Segmento.Inla.nb,</span>
<span class="st">                                scale.model = TRUE,</span>
<span class="st">                                constr = T,</span>
<span class="st">                                adjust.for.con.comp = T)&#39;</span>),
                              <span class="st">&quot;pred&quot;</span>) <span class="co"># rescale to allow the Newton-Raphson optimizer to converge</span>
  
  <span class="cf">if</span>(family<span class="op">==</span><span class="st">&quot;gaussian&quot;</span>){
    formula_test &lt;-<span class="st"> </span><span class="kw">reformulate</span>(<span class="kw">c</span>(<span class="st">&quot;-1&quot;</span>, <span class="st">&quot;intercept&quot;</span>,
                                  <span class="kw">paste</span>(candidate_covariates[<span class="op">-</span>ix],<span class="dt">collapse=</span><span class="st">&quot;+&quot;</span>),
                                  <span class="st">&#39;f(ID,model = &quot;bym2&quot;,</span>
<span class="st">                                hyper=list(</span>
<span class="st">                                prec = list(prior = &quot;pc.prec&quot;, param = c(0.1, 0.0001)),</span>
<span class="st">                                phi  = list(prior = &quot;pc&quot;, param = c(0.5, 0.5))),</span>
<span class="st">                                graph = Segmento.Inla.nb,</span>
<span class="st">                                scale.model = TRUE,</span>
<span class="st">                                constr = T,</span>
<span class="st">                                adjust.for.con.comp = T)&#39;</span>),
                                <span class="st">&quot;pred/10&quot;</span>) <span class="co"># rescale to allow the Newton-Raphson optimizer to converge</span>
  }
  <span class="co"># fit the model</span>
  <span class="cf">if</span>(family<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;beta&quot;</span>,<span class="st">&quot;zeroinflatedbinomial1&quot;</span>)){
    bym.res=INLA<span class="op">::</span><span class="kw">inla</span>(<span class="dt">formula=</span>formula_test, 
                       <span class="dt">family =</span> family, 
                       <span class="dt">data =</span> mod_data_jack,
                       <span class="dt">Ntrials =</span> mod_data_jack<span class="op">$</span>n_obs,
                       <span class="dt">control.predictor=</span><span class="kw">list</span>(<span class="dt">link=</span><span class="dv">1</span>,<span class="dt">compute=</span>T),
                       <span class="dt">control.compute=</span><span class="kw">list</span>(<span class="dt">dic=</span>T, <span class="dt">cpo=</span>F),
                       <span class="dt">control.inla =</span><span class="kw">list</span>(<span class="dt">int.strategy =</span> <span class="st">&quot;eb&quot;</span>)
    )
  }<span class="cf">else</span>{
    
    bym.res=INLA<span class="op">::</span><span class="kw">inla</span>(<span class="dt">formula=</span>formula_test, 
                       <span class="dt">family =</span> family, 
                       <span class="dt">data =</span> mod_data_jack,
                       <span class="dt">control.predictor=</span><span class="kw">list</span>(<span class="dt">link=</span><span class="dv">1</span>,<span class="dt">compute=</span>T),
                       <span class="dt">control.compute=</span><span class="kw">list</span>(<span class="dt">dic=</span>T, <span class="dt">cpo=</span>F),
                       <span class="dt">control.inla =</span><span class="kw">list</span>(<span class="dt">int.strategy =</span> <span class="st">&quot;eb&quot;</span>) 
    )
  }
  <span class="co"># extact fitted values</span>
  M_fit=bym.res<span class="op">$</span>summary.fitted.values[,<span class="st">&quot;mean&quot;</span>]
  
  <span class="cf">if</span>(family<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;gamma&quot;</span>)){
    M_fit=<span class="kw">exp</span>(M_fit) <span class="co"># back transform to level</span>
  }
  <span class="cf">if</span>(family<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;gaussian&quot;</span>)){
    M_fit=M_fit<span class="op">*</span><span class="dv">10</span> <span class="co"># back transform to level</span>
  }
  
  <span class="co"># funcion for RMSE </span>
  RMSE=<span class="cf">function</span>(set,outcome,data){
    res =<span class="st"> </span>data[set,outcome]<span class="op">-</span>M_fit[set]
    RMSE_val &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>(res<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span>T)) 
    <span class="kw">return</span>(RMSE_val)  
  }
  <span class="co"># funcion for pseudo_r2</span>
  pseudo_r2=<span class="cf">function</span>(set,outcome,data){
    res =<span class="st">  </span>data[set,outcome]<span class="op">-</span>M_fit[set]
    RRes=<span class="kw">sum</span>((res)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm =</span> T)
    RRtot=<span class="kw">sum</span>((data[set,outcome]<span class="op">-</span><span class="kw">mean</span>(M_fit[set],<span class="dt">na.rm=</span>T))<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm =</span> T)
    pseudo_r2_val=<span class="dv">1</span><span class="op">-</span>RRes<span class="op">/</span>RRtot
    <span class="kw">return</span>(pseudo_r2_val)  
  }
  
  <span class="co"># RMSE: RMSE  function defined above</span>
  RMSE_val=<span class="kw">RMSE</span>(index_val,outcome,mod_data_jack)
  RMSE_train=<span class="kw">RMSE</span>(index_train,outcome,mod_data_jack)
  
  <span class="co"># R2: pseudo_r2 function defined above</span>
  r2_val=<span class="kw">pseudo_r2</span>(index_val,outcome,mod_data_jack)
  r2_train=<span class="kw">pseudo_r2</span>(index_train,outcome,mod_data_jack)
  
  <span class="co"># store results</span>
  results_list=<span class="kw">list</span>(<span class="st">&quot;cov_i&quot;</span>=ix,
                    <span class="st">&quot;cov_name&quot;</span>=candidate_covariates[ix],
                    <span class="st">&quot;formula&quot;</span>=formula_test,
                    <span class="co"># &quot;fitted_values&quot;=M_fit,</span>
                    <span class="co"># &quot;index_val&quot;=index_val,</span>
                    <span class="co"># &quot;index_train&quot;=index_train,</span>
                    <span class="co"># &quot;index_train_val&quot;=index_train_val,</span>
                    <span class="st">&quot;RMSE_val&quot;</span>=RMSE_val,
                    <span class="st">&quot;RMSE_train&quot;</span>=RMSE_train,
                    <span class="st">&quot;r2_val&quot;</span>=r2_val,
                    <span class="st">&quot;r2_train&quot;</span>=r2_train,
                    <span class="st">&quot;outcome&quot;</span>=outcome,
                    <span class="st">&quot;family&quot;</span>=family)
  <span class="kw">rm</span>(bym.res)
  <span class="kw">return</span>(results_list)
}</code></pre></div>
<p>We can now test the function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test the function #####</span>
test_fct=<span class="kw">INLA_steps_2_4</span>(covariates_formulation, <span class="co"># formulation of each covariate</span>
                        <span class="dv">1</span>, <span class="co"># the index of the covariate to be removed</span>
                        index_val_jack, <span class="co"># index of the validation set</span>
                        index_train_jack, <span class="co"># index of the validation set</span>
                        mod_data_jack, <span class="co"># data for the model</span>
                        <span class="st">&quot;ingpe&quot;</span>, <span class="co"># outcome</span>
                        <span class="st">&quot;gaussian&quot;</span>) <span class="co"># likelihood</span></code></pre></div>
<p>The results can then be accessed using the <code>$</code> sign. For instance, we can look at the <span class="math inline">\(R^2\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;R-squared in the validation set:&quot;</span>,test_fct<span class="op">$</span>r2_val,
            <span class="st">&quot;R-squared in the training set:&quot;</span>,test_fct<span class="op">$</span>r2_train))</code></pre></div>
<pre><code>## [1] &quot;R-squared in the validation set: 0.433658851976307 R-squared in the training set: 0.488908504755652&quot;</code></pre>
</div>
<div id="bundle-step-5-to-7-in-a-loop-ran-in-parallel" class="section level2">
<h2><span class="header-section-number">7.3</span> Bundle step 5 to 7 in a loop ran in parallel</h2>
<p>We can now launch the entire backward selection process with a loop. In order to speed up the process, we parallelise the estimation of each single model across the cores: each core is in charge of estimating one model. In the first iteration of the loop, we start with a list of <span class="math inline">\(50\)</span> candidate covariates. <span class="math inline">\(50\)</span> models are estimated. Each model contains all covariates minus one <span class="math inline">\(j\)</span> covariate, where <span class="math inline">\(j\)</span> is different in each model and <span class="math inline">\(j=1, ..., 50\)</span>. Once the <span class="math inline">\(50\)</span> models have been estimated, results are collected and the best performing model is identified, say model <em>k</em> The corresponding <span class="math inline">\(k\)</span> covariate is removed from the list of candidate covariate and the loop proceed to the next iteration with a list of <span class="math inline">\(50-1=49\)</span> candidate covariates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># loop over all covariates until only 1 is left #####</span>
candidate_covariates=covariates_formulation <span class="co"># start again with the full list of candidate covariate</span>
n2drop=<span class="kw">length</span>(covariates_formulation)<span class="op">-</span><span class="dv">1</span> 
start_t=<span class="kw">Sys.time</span>()
results_jacknife=<span class="kw">list</span>() <span class="co"># create a list to store all the results of the jacknife selectio process</span>
<span class="cf">for</span>(n_cov_to_drop <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n2drop){  <span class="co"># repeat the step n2drop=12 times until having only 8 covariates</span>
  
  <span class="kw">set.seed</span>(<span class="dv">101</span>)
  
  INLA_steps_2_4_par=<span class="cf">function</span>(cov_n){  <span class="co"># fit the model dropping one covariates after the other</span>
    model_fct=<span class="kw">INLA_steps_2_4</span>(candidate_covariates, <span class="co"># formulation of each covariate</span>
                             cov_n, <span class="co"># the index of the covariate to be removed</span>
                             index_val_jack, <span class="co"># index of the validation set</span>
                             index_train_jack, <span class="co"># index of the validation set</span>
                             mod_data_jack,  <span class="co"># data for the model</span>
                             <span class="st">&quot;ingpe&quot;</span>, <span class="co"># outcome</span>
                             <span class="st">&quot;gaussian&quot;</span>) <span class="co"># likelihood</span>
    <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\014</span><span class="st">&quot;</span>) <span class="co"># clean the consol</span>
    <span class="co"># print(paste(&quot;loop&quot;,n_cov_to_drop, &quot;of&quot;, n2drop, &quot;cov to drop;&quot;, &quot;cov&quot;,cov_n, &quot;r2&quot;,model_fct$r2_val))</span>
    
    <span class="co"># end_t=Sys.time()</span>
    <span class="co"># duration=end_t-start_t</span>
    <span class="co"># print(duration)</span>
    <span class="kw">return</span>(model_fct)
  }
  cov_n&lt;-<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(candidate_covariates)
  n_cores&lt;-<span class="kw">detectCores</span>()
  cl=<span class="kw">makeCluster</span>(n_cores)
  start_T&lt;-<span class="kw">Sys.time</span>()
  <span class="kw">clusterExport</span>(<span class="dt">cl=</span>cl,
                <span class="dt">varlist=</span><span class="kw">c</span>(<span class="st">&quot;candidate_covariates&quot;</span>,
                          <span class="st">&quot;INLA_steps_2_4&quot;</span>,
                          <span class="st">&quot;index_val_jack&quot;</span>,
                          <span class="st">&quot;index_train_jack&quot;</span>,
                          <span class="st">&quot;mod_data_jack&quot;</span>,
                          <span class="st">&quot;Segmento.Inla.nb&quot;</span>))
  results_list&lt;-<span class="kw">clusterApply</span>(cl,cov_n,INLA_steps_2_4_par)
  end_T&lt;-<span class="kw">Sys.time</span>()
  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\014</span><span class="st">&quot;</span>) <span class="co"># clean the consol</span>
  <span class="kw">print</span>(end_T<span class="op">-</span>start_T)
  <span class="kw">stopCluster</span>(cl)
  <span class="kw">gc</span>()
  <span class="co"># store all the results for quality check</span>
  results_jacknife[[n_cov_to_drop]]=results_list 
  
  <span class="co"># drop covariate affecting the least the goodness of fit </span>
  
  rmse_val=<span class="kw">lapply</span>(results_list,<span class="cf">function</span>(x) <span class="kw">unlist</span>(x<span class="op">$</span>RMSE_val))
  rmse_val_min=<span class="kw">which.min</span>(rmse_val)
  
  covariates_to_be_removed=results_list[[rmse_val_min]]<span class="op">$</span>cov_name
  
  candidate_covariates=candidate_covariates[<span class="op">-</span><span class="kw">which</span>(candidate_covariates<span class="op">==</span>covariates_to_be_removed)]
  <span class="kw">rm</span>(results_list)
  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">length</span>(candidate_covariates),<span class="st">&quot;covariates remaining&quot;</span>))
  
}
end_t=<span class="kw">Sys.time</span>()
duration=end_t<span class="op">-</span>start_t
<span class="kw">print</span>(duration) <span class="co"># 1.84 hours</span></code></pre></div>
<p>The process took slightly less than 2 hours on a cloud instance with 64 cores.</p>
</div>
<div id="step-8-inspect-the-results-and-select-specification" class="section level2">
<h2><span class="header-section-number">7.4</span> Step 8: Inspect the results and select specification</h2>
<p>We can now inspect the results of the selection process. Let us look at the goodness of fit of the best performing models at each covariate selection step, using the R-squared and the RMSE as goodness of fit statistics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># INCOME Bym2 ####</span>
<span class="kw">load</span>(<span class="kw">paste0</span>(dir_data,<span class="st">&quot;workspace/income_bym2_gaussian.RData&quot;</span>))

<span class="co"># visualize R2  ####</span>
<span class="co"># extract r2</span>
r2_val_max=r2_train_max=r2_val_min=r2_train_min=<span class="kw">c</span>()
<span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(results_jacknife)){
  r2_val=<span class="kw">lapply</span>(results_jacknife[[k]],<span class="cf">function</span>(x) <span class="kw">unlist</span>(x<span class="op">$</span>r2_val))
  r2_train=<span class="kw">lapply</span>(results_jacknife[[k]],<span class="cf">function</span>(x) <span class="kw">unlist</span>(x<span class="op">$</span>r2_train))
  
  <span class="co"># get max r2</span>
  r2_val_max_index=<span class="kw">which.max</span>(r2_val)
  r2_val_max_i=r2_val[[r2_val_max_index]]
  r2_train_max_i=r2_train[[r2_val_max_index]]
  
  r2_val_max=<span class="kw">c</span>(r2_val_max,r2_val_max_i)
  r2_train_max=<span class="kw">c</span>(r2_train_max,r2_train_max_i)
  
  <span class="co"># get min r2</span>
  r2_val_min_index=<span class="kw">which.min</span>(r2_val)
  r2_val_min_i=r2_val[[r2_val_min_index]]
  r2_train_min_i=r2_train[[r2_val_min_index]]
  
  r2_val_min=<span class="kw">c</span>(r2_val_min,r2_val_min_i)
  r2_train_min=<span class="kw">c</span>(r2_train_min,r2_train_min_i)
}

<span class="co"># viz r2</span>
data2plot=<span class="kw">data.frame</span>(<span class="dt">set=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;val&quot;</span>,<span class="kw">length</span>(r2_val_max)),<span class="kw">rep</span>(<span class="st">&quot;train&quot;</span>,<span class="kw">length</span>(r2_val_max))),
                     <span class="dt">index=</span><span class="kw">c</span>(<span class="kw">rev</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(r2_val_max)),<span class="kw">rev</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(r2_val_max))),
                     <span class="dt">index_jack=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(r2_val_max),<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(r2_val_max)),
                     <span class="dt">r2_max=</span><span class="kw">c</span>(<span class="kw">unlist</span>(r2_val_max),<span class="kw">unlist</span>(r2_train_max)),
                     <span class="dt">r2_min=</span><span class="kw">c</span>(<span class="kw">unlist</span>(r2_val_min),<span class="kw">unlist</span>(r2_train_min)))

plotly<span class="op">::</span><span class="kw">plot_ly</span>(<span class="dt">data=</span>data2plot,
                <span class="dt">x=</span><span class="op">~</span>index_jack,
                <span class="dt">y=</span><span class="op">~</span>r2_max,
                <span class="dt">name =</span> <span class="op">~</span>set,
                <span class="dt">type=</span><span class="st">&quot;scatter&quot;</span>,
                <span class="dt">mode=</span><span class="st">&quot;line&quot;</span>)</code></pre></div>
<div id="htmlwidget-883e745ecf0278870a6f" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-883e745ecf0278870a6f">{"x":{"visdat":{"89fc2df36240":["function () ","plotlyVisDat"]},"cur_data":"89fc2df36240","attrs":{"89fc2df36240":{"x":{},"y":{},"mode":"line","name":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"index_jack"},"yaxis":{"domain":[0,1],"automargin":true,"title":"r2_max"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39],"y":[0.503379750408935,0.495817839508031,0.49103557692346,0.489114466948889,0.485087375331708,0.483232684900609,0.481185818567013,0.48081965189631,0.480694341056751,0.479516798227265,0.479408178978352,0.476940037178042,0.475986787493983,0.475799099085215,0.474989742889438,0.472853984414298,0.470126863565677,0.470011264143951,0.469932919017184,0.468132397104931,0.466409802914662,0.466389487999065,0.465407891552569,0.45808018493941,0.457981064797186,0.457046403611638,0.456673674855469,0.455981984184691,0.453508901236946,0.447348588753317,0.445547940957851,0.44354249496866,0.441340528561004,0.439252115497677,0.424785625280583,0.420284540397423,0.419288898834228,0.415364613173235,0.411375246727817],"mode":"line","name":"train","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39],"y":[0.431293622810968,0.438951612188426,0.444859580160301,0.44886806651547,0.451494483400088,0.454023152213404,0.455986416765947,0.457920745766429,0.459295966921566,0.460874166043312,0.462071732568768,0.463446267951573,0.465995536749402,0.46819306933293,0.469789803136871,0.470522577702839,0.471294928710727,0.471892711421959,0.472208108975121,0.472622033461956,0.474352180498782,0.47464002938828,0.474768258816595,0.474697313533322,0.474481632181858,0.474106260668896,0.472284570754148,0.471665493599704,0.471278378314033,0.470283233982113,0.468492637335055,0.466450249619621,0.463510059590941,0.461448564580026,0.456149706850014,0.450067158906855,0.44352948971582,0.441298226387206,0.43017917468986],"mode":"line","name":"val","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># visualize RMSE  ####</span>
<span class="co"># extract RMSE</span>
RMSE_val_max=RMSE_train_max=RMSE_val_min=RMSE_train_min=<span class="kw">c</span>()
<span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(results_jacknife)){
  RMSE_val=<span class="kw">lapply</span>(results_jacknife[[k]],<span class="cf">function</span>(x) <span class="kw">unlist</span>(x<span class="op">$</span>RMSE_val))
  RMSE_train=<span class="kw">lapply</span>(results_jacknife[[k]],<span class="cf">function</span>(x) <span class="kw">unlist</span>(x<span class="op">$</span>RMSE_train))
  
  <span class="co"># get max RMSE</span>
  RMSE_val_max_index=<span class="kw">which.max</span>(RMSE_val)
  RMSE_val_max_i=RMSE_val[[RMSE_val_max_index]]
  RMSE_train_max_i=RMSE_train[[RMSE_val_max_index]]
  
  RMSE_val_max=<span class="kw">c</span>(RMSE_val_max,RMSE_val_max_i)
  RMSE_train_max=<span class="kw">c</span>(RMSE_train_max,RMSE_train_max_i)
  
  <span class="co"># get min RMSE</span>
  RMSE_val_min_index=<span class="kw">which.min</span>(RMSE_val)
  RMSE_val_min_i=RMSE_val[[RMSE_val_min_index]]
  RMSE_train_min_i=RMSE_train[[RMSE_val_min_index]]
  
  RMSE_val_min=<span class="kw">c</span>(RMSE_val_min,RMSE_val_min_i)
  RMSE_train_min=<span class="kw">c</span>(RMSE_train_min,RMSE_train_min_i)
}

<span class="co"># viz RMSE</span>
data2plot=<span class="kw">data.frame</span>(<span class="dt">set=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;val&quot;</span>,<span class="kw">length</span>(RMSE_val_max)),<span class="kw">rep</span>(<span class="st">&quot;train&quot;</span>,<span class="kw">length</span>(RMSE_val_max))),
                     <span class="dt">index=</span><span class="kw">c</span>(<span class="kw">rev</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(RMSE_val_max)),<span class="kw">rev</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(RMSE_val_max))),
                     <span class="dt">RMSE_max=</span><span class="kw">c</span>(<span class="kw">unlist</span>(RMSE_val_max),<span class="kw">unlist</span>(RMSE_train_max)),
                     <span class="dt">RMSE_min=</span><span class="kw">c</span>(<span class="kw">unlist</span>(RMSE_val_min),<span class="kw">unlist</span>(RMSE_train_min)))

plotly<span class="op">::</span><span class="kw">plot_ly</span>(<span class="dt">data=</span>data2plot,
                <span class="dt">x=</span><span class="op">~</span>index,
                <span class="dt">y=</span><span class="op">~</span>RMSE_min,
                <span class="dt">name =</span> <span class="op">~</span>set,
                <span class="dt">type=</span><span class="st">&quot;scatter&quot;</span>,
                <span class="dt">mode=</span><span class="st">&quot;line&quot;</span>)</code></pre></div>
<div id="htmlwidget-392ea837f3bfe3f491bf" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-392ea837f3bfe3f491bf">{"x":{"visdat":{"89fc516e4d4d":["function () ","plotlyVisDat"]},"cur_data":"89fc516e4d4d","attrs":{"89fc516e4d4d":{"x":{},"y":{},"mode":"line","name":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"index"},"yaxis":{"domain":[0,1],"automargin":true,"title":"RMSE_min"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[39,38,37,36,35,34,33,32,31,30,29,28,27,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1],"y":[50.7081542875387,51.092755880281,51.3344961949211,51.4312871721322,51.6335946720472,51.7265019446705,51.8288425891943,51.8471291434135,51.8533857511885,51.9121420995353,51.9175585694911,52.0404844131679,52.0878833704749,52.0972108232074,52.1374138612592,52.2727515408156,52.3783173069583,52.3840305364794,52.3879022054974,52.4768018971357,52.5617132177983,52.562713775109,52.6110370990989,52.9703822280884,52.9752262940129,53.0208820434791,53.0390779052037,53.0728283098024,53.1933249418807,53.4922952362437,53.5793686174376,53.676179100871,53.7822756565905,53.88270788691,54.5733302333718,54.7864338521517,54.8334605855586,55.0184233427702,55.2058183415762],"mode":"line","name":"train","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[39,38,37,36,35,34,33,32,31,30,29,28,27,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1],"y":[66.1086637669376,65.6470671676923,65.3009863013862,65.0673104896826,64.9002699623185,64.7503233171891,64.6355071545136,64.5222465857433,64.4385793611202,64.3369458319301,64.2646488173377,64.1814136264165,64.0294005088522,63.8986496164153,63.8079060223651,63.760085046218,63.7107534078668,63.6745886848589,63.655932635453,63.6267516561677,63.5197436458985,63.5028569213539,63.4985360245581,63.4982445613652,63.5117256294001,63.5328319652062,63.6428783736901,63.6790047816533,63.7019406301172,63.7682074606361,63.8748954116243,63.993922611896,64.1705087272733,64.2980378101558,64.6159224364722,64.9825963300389,65.379246013568,65.4991513048793,66.1431702141745],"mode":"line","name":"val","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
<p>Based on the results above, the 31st step appears to provide a good balance between the sparsity of the formulation and the goodness of fit.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># identify the specification ####</span>
step_chosen=<span class="dv">31</span>  
r2_val=<span class="kw">lapply</span>(results_jacknife[[step_chosen]],<span class="cf">function</span>(x) <span class="kw">unlist</span>(x<span class="op">$</span>r2_val))
r2_val_max_index=<span class="kw">which.max</span>(r2_val)

formula_selected=results_jacknife[[step_chosen]][[r2_val_max_index]]<span class="op">$</span>formula
formula_selected</code></pre></div>
<pre><code>## pred/10 ~ -1 + intercept + chirps_ev_med + lights_med + dist2coast_r + 
##     pop_dens + lc_tree + dens_all_roads + dens_secondary + dens_bus + 
##     LZ_CentralIndusServ + f(ID, model = &quot;bym2&quot;, hyper = list(prec = list(prior = &quot;pc.prec&quot;, 
##     param = c(0.1, 1e-04)), phi = list(prior = &quot;pc&quot;, param = c(0.5, 
##     0.5))), graph = Segmento.Inla.nb, scale.model = TRUE, constr = T, 
##     adjust.for.con.comp = T)
## &lt;environment: 0x00000000230da958&gt;</code></pre>
<p>Here is the list of covariates that were selected:</p>
<ul>
<li>chirps_ev_med: median precipitation</li>
<li>lights_med: median lights over the year</li>
<li>dist2coast_r: distance to coast</li>
<li>pop_dens: population density</li>
<li>lc_tree: percentage of trees</li>
<li>dens_all_roads: road density (all road categories)</li>
<li>dens_secondary: secondary road density</li>
<li>dens_bus : bus lanes density</li>
<li>LZ_CentralIndusServ: Central Livelihood zones on industry and services.</li>
</ul>
</div>
<div id="step-9-final-test" class="section level2">
<h2><span class="header-section-number">7.5</span> Step 9 Final test</h2>
<p>Lastly, we perform the final test of goodness of fit on the test set. As a reminder, the test set comprise of 20% of the data we set aside before starting the selection process, i.e. the model has not yet <em>seen</em> them.</p>
<p>We start by building the dataframe for estimating the final model with the training and test set only.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># build dataframe for final test ####</span>
data_test=data_model
data_test<span class="op">$</span>pred=data_test<span class="op">$</span>ingpe <span class="co"># create a pred variables equal to ingpe, the outcome variable</span>
<span class="co"># data_test$pred[index_test] &lt;- NA # set the test pred to NA: they will be predicted by the model and compared with observed </span>
data_test<span class="op">$</span>pred[<span class="kw">c</span>(index_test, index_val)] &lt;-<span class="st"> </span><span class="ot">NA</span> <span class="co"># set the test pred to NA: they will be predicted by the model and compared with observed </span>
data_test=data_test[<span class="kw">c</span>(index_test,index_train),]

index_train_bis=<span class="kw">which</span>(<span class="kw">is.na</span>(data_test<span class="op">$</span>pred)<span class="op">==</span>F)
index_test_bis=<span class="kw">which</span>(<span class="kw">is.na</span>(data_test<span class="op">$</span>pred))</code></pre></div>
<p>The estimation is done with the usual <code>inla</code> function and are plotted on Fig. <a href="stepwise.html#fig:test-bym2">7.1</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:test-bym2"></span>
<div id="htmlwidget-b945298f520871ebd5ee" style="width:80%;height:288px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b945298f520871ebd5ee">{"x":{"visdat":{"89fc208f3b5":["function () ","plotlyVisDat"]},"cur_data":"89fc208f3b5","attrs":{"89fc208f3b5":{"y":[160.596767118734,126.255302146859,115.386230210977,100.156733433431,96.2590364362832,108.720673374269,104.99471321528,105.102018115585,89.9602484982416,99.3338878988703,109.406551846377,102.44508501964,118.852735813648,93.8615376445042,112.547343550218,111.367221523549,98.6318986324381,103.621857471154,116.525586965151,187.205377556329,116.725667826427,98.3468010137114,99.0741683538882,92.5784476623061,111.47735496417,104.766513235616,104.287480059132,97.0509841083531,128.9202356985,130.875941423679,111.39299948511,134.575561028776,97.0327447188443,95.2218133933539,133.355234597176,92.5498619454802,92.2972791016104,91.97797316833,103.575731816203,117.736650158859,101.192990850015,97.7049174563695,109.216743019206,97.5893681376586,91.2518614079524,99.5761786232001,228.343220514777,120.726528115176,91.0174096125785,169.382685469353,98.6918592065605,98.0488287414441,156.3518718949,95.877824447783,156.642307964971,101.636088554147,97.3297486756288,112.219248086636,103.349800884428,120.416652449813,91.212673023318,156.061080838751,96.9147737528253,99.7456730214022,84.0064595940726,105.176940140276,116.6969311106,147.393849147024,115.795575261719,105.724855859829,92.4216510660921,107.090124851298,93.8314676802531,98.6235716476698,181.063386891017,107.474335025641,97.3176059378603,103.283674701128,98.1840406917408,183.949658107069,163.770865039151,99.1925626331388,129.344571155595,263.735866471994,104.275663297275,94.6861826465779,95.3119719731352,148.850939294593,141.798756635708,164.560438803419,181.524928426615,144.47818532378,136.763372633128,114.744883934138,117.423386460437,117.453244357376,150.998806254585,111.072230394812,124.29100976536,104.542530205427,247.373209601251,94.160376034206,107.076233206515,162.981869766208,247.101420342064,151.444068162762,312.597956041754,144.24394502688,216.368299526226,106.891315321832,321.031441920283,205.543743718817,115.282713603748,130.643941912279,119.755671576629,105.627182394262,103.385162703708,130.418737940489,197.516492136903,98.6683279585014,137.750779009335,106.900546355766,107.751834843341,108.160290869421,120.429523982516,132.258322252282,96.9075291482402,114.31133331811,92.3097714645017,132.810728183118,109.372415287862,152.939823627308,154.685973575068,219.748542597274,147.337419243088,159.379643639457,89.3929818206799,147.564158121505,148.641649684716,162.065459782033,197.28190211485,102.337719834767,151.855561673296,128.736192577875,119.053870761874,137.247740327913,153.06542368091,132.132595686259,232.125825857585,93.3281979481863,92.8706563869682,124.201771744007,111.873107844306,94.3967595464083,95.4121014370985,97.6636571907916,95.3934187998226,95.381967723698,165.845567406576,94.154087767225,93.2370491329129,103.712361333487,113.114424848468,99.3172556179095,176.238629803914,122.826661635198,83.9210415651718,95.1030519486318,187.674089733338,143.964668937467,126.619146341772,224.658905249353,164.714981488293,159.666747715093,80.4479411080057,172.437296413237,147.787196638955,114.374897696229,209.191234518795,111.634870359029,205.423933827079,107.0486870524,242.997121376963,118.394576672077,126.519677283063,206.905458830733,149.253785398047,150.428033920764,184.838796143855,161.082029081774,142.070097283061,209.120330529361,130.664167949182,127.020128588098,183.430636165568,176.816672889959,119.534254731335,218.841809209286,140.346142024344,104.688728925107,171.091084395371,173.58924091217,171.566959683287,158.21073614485,99.2977309177127,102.527972055222,219.053926536115,205.043764444077,236.385553768823,204.431923951899,179.524264565722,95.0548871792547,166.601165955312,192.033303449826,263.322245466031,127.291602274969,146.24818549855,172.904597950384,99.927008942623,149.121350256657,173.592884948677,187.897919834677,100.963223496318,105.427529868546,108.168163388325,177.474948144017,138.132012829021,253.336840174083,143.649494649157,80.2920621841093,91.7673404674915,98.5019191665863,105.889418384298,195.456430911794,85.0812662182645,87.8211423903883,98.531868987154,109.137977447574,90.8633162001672,101.679370632402,122.457051489234,132.256165145365,124.952073645899,86.2971998085249,118.575545963561,190.013767566887,94.3503671281795,195.80228007324,146.241128243961,186.477599296501,105.067414723335,99.2235929425775,109.140213839229,155.521384811801,134.997668615585,110.258688739696,106.626474534292,109.08605820726,106.057969384076,124.648408124064,137.642805686805,153.67700479544,156.421578498055,171.552049118862,106.226769978469,110.323957701364,162.284170221097,124.468934113689,105.352982806141,113.39312514796,118.172758991327,156.340072036747,96.1778390981149,107.111177702342,103.295978550924,136.562985112114,108.371450814328,105.675808714374,99.7524599068119,114.888795733074,107.915678975907,108.594757434886,109.193754163064,106.658923927137,108.28040256468,109.985064258753,114.574571692344,98.6298864216477,98.1288226477802,108.185440346085,99.4620345722259,107.588449839408,104.421665637158,126.235956313176,105.892853991997,119.671396382017,119.277122931243,120.764555841968,139.862873480217,98.905590787334,91.9537464996884,91.6106560435073,111.793876467763,128.586505799354,153.574734178023,122.16793485587,107.18059165109,97.6771500749647,103.728230891649,144.172461083383,118.502143540951,99.5943448885549,96.5064380480211,98.3128095683628,168.728775655499,172.122130284429,341.666653388772,109.450267937091,220.67359085726,265.254946154626,115.132098682825,163.986337359429,106.717860503584,108.452232864647,102.290893836669,104.30081826285,158.17235493671,134.398896515332,114.093712461885,100.11912155132,129.838918758627,103.829547727026,111.98015532405,106.716844661155,131.631315544321,151.8094568752,100.957200253909,106.300708588488,99.5991101622557,121.880252381266,104.279218077928,122.636902350447,95.9179688913546,110.465451315123,177.822192070127,92.1406907580817,94.2163027140859,93.2811767947842,186.301610606185,142.549107283326,123.479253206089,120.259684761627,110.67004641499,209.130529293242,140.36170869369,164.077210304422,237.032820373204,231.461725671503,130.89597900279,147.526852864383,205.742179744692,118.833889378908,100.438060420054,101.910571947845,98.0999772166277,112.250367347859,105.181813230186,144.128395419422,96.653293979945,96.5263802506137,121.887482454049,111.409590987336,238.786553887002,103.443554421192,122.636082579094,112.358678835364,92.591578731388,147.497742837664,92.8446533928229,93.4534188722699,147.815188394754,96.4402924957499,194.644623444842,148.99335315926,110.387090736536,87.9587792383236,200.304828547343,98.8910091756283,201.305439910217,121.884455641935,110.320145593096,315.654655916379,271.851392534334,107.530862046892,139.644132729728,168.503854246342,145.212801439785,116.836583847796,124.176573391997,94.1386303074329,94.8462550201626,99.6094156895326,94.5606057641781,95.880792992902,120.58526084358,95.728871703321,125.090602035616,103.008368940738,101.000309036787,102.002530959291,116.629060219839,95.3089264345707,93.2140216989786,107.134470827259,135.628476194396,93.566346841488,133.807095905801,146.180087600606,95.5845167651861,101.074974186471,104.349848404383,99.3556542112748,98.2222596379494,99.9093103008138,111.017998132933,93.2960236018848,126.024352742576,157.413310613656,150.367275518772,95.301952298583,92.8243649718984,93.4913774358635,93.0307523589142,105.274348768905,164.793688152841,93.3789737140662,193.933038409291,98.0811492970946,100.764106671864,193.780109811664,102.236726715198,101.362658411608,96.9434210820107,101.179396888558,143.043537227546,96.8809580851912,121.055925099511,153.023476431157,148.65074293548,102.69612483015,91.9291327367355,97.1236097031364,87.9183369180739,128.212943076105,97.537116772711,112.678056230689,125.492976138052,173.032806864575,157.320902770591,131.35792413317,120.995549028277,95.9391292225123,96.5785092941055,94.6985447317034,93.7608236709517,93.5715649365454,97.2542279422714,111.717761914946,99.1483209505339,92.9560713983874,117.157601704114,91.7240262757473,98.1642656495137,94.838666521993,141.770740414732,115.081279812221,95.3735271040993,104.926347847405,156.345412885693,101.952498987673,119.300325218759,115.338009501424,102.142691866448,158.302558362244,148.128493104484,209.861211363716,149.113499812425,116.74780774145,94.5612455092559,126.453712672824,88.2165040809966,94.2133249945515,95.0088670822385,100.554039779383,89.6917123937191,90.6712050470018,114.953703558276,101.741113916539,157.305899735407,113.22841002521,93.0740421276449,113.717151671104,117.524889305717,116.988206795714,116.744227242856,108.051379343776,147.709314541366,139.811520440382,92.7727335673452,103.107614570614,91.172182126109,79.9496592086679,166.894149441776,97.1307279899404,96.7660112561836,102.465554112745,134.92337659287,145.808824149182,98.966915813299,188.339883394377,166.827461156245,100.334565403186,103.182093460172,99.3343221210392,200.425139937734,124.54430355298,98.454406796611,96.7826457434917,103.08064994423,97.8170346752735,96.8920434123592,101.804526777921,100.098919834646,132.962970570788,154.543890493628,131.622620259753,95.097281990493,122.388554541637,101.201906780725,132.300426757276,119.814993397053,219.495147881834,178.822924732464,208.699036628699,296.398554356406,263.774809708049,127.071175802388,180.478391825065,105.925142384904,128.99352584188,130.542754604101,103.89983269756,103.91370190929,150.736752748982,148.614004776747,129.38619170611,145.839156859695,145.95522964911,105.323746550506,113.276453777686,131.848951461512,136.258443880814,137.474084208582,263.211558627734,212.204969798207,179.639711792699,163.736836418387,137.24341226414,147.113508090941,123.9350325882,100.26281517243,101.584563222923,183.263200614091,94.777409884171,110.245866515708,108.940924540293,99.7264370080746,93.223698722041,113.920642741994,136.916534136236,269.286079561857,256.928344292472,318.574197456865,363.285124208164,300.340729110175,336.3629539976,310.785672878312,130.784191502817,288.56038469546,352.73661003465,227.881699089667,104.145231370018,188.942493705327,217.251677683358,102.805726305713,106.294049255199,185.763765551003,122.915878092237,127.027369602764,116.160497209413,109.890537105237,116.967703361949,124.632425698498,114.106765536748,110.378001366573,192.846190173725,109.241803258169,124.424088183707,170.24198973685,111.545782876171,128.051592057123,112.373156800543,109.157741873502,107.970702601212,103.854266253732,181.060066431241,105.599292810341,110.746154822818,151.707266409964,227.916610523168,110.655493169416,118.428125950981,122.472000170729,105.257467999058,98.3211744436037,97.67195441989,130.035552733458,110.354327945077,123.85074923394,109.593375018176,93.3182073447588,97.7861203392926,98.1956156604486,97.1888583522508,91.3449399227442,136.266164989891,247.853659392805,126.007519982831,101.94790897589,132.358539636309,141.927013427411,116.128825388169,131.824392009375,98.1362289708908,111.159387714731,92.4685050328361,94.2599540922182,122.741339764769,121.958403501559,175.339773218717,106.88446454187,113.129130153499,106.16221933809,93.1054274724864,96.6877687971962,101.485434244562,101.771332809048,145.269195780572,102.892431096209,101.638568221914,98.477239022517,104.774721265934,107.496418038995,141.180791391743,175.122908990255,158.445206056571,106.525106765794,101.026647806536,87.5637898439569,108.066663426395,96.6430044577464,93.0563166456112,152.486355232196,145.977092482758,189.906740710519,192.971380102952,117.122938010551,183.04764010456,218.89887730893,171.322332361092,227.766159731345,266.814109488593,239.865263442316,217.002658941501,106.799596470139,156.672664046868,144.880675273881,93.3259576838161,95.4456831046365,97.5122040270284,95.5231113723746,95.5529010701785,99.4516178253999,180.767084892156,140.687544022066,103.222527396757,109.289100301028,101.947387859787,96.7735830042592,123.922587292743,94.6712866320567,108.24220583623,98.9614827401609,93.1554603801504,110.202075938125,95.0385124995253,94.7252118327074,95.2854942426536,93.4447037530462,102.655406100395,118.252015764889,95.9484730249348,97.5114429067255,97.2545566503545,104.858130870397,95.1232215884615,95.3374697628357,102.06074799813,94.1778661634697,92.861238919192,95.5274283110172,93.8955691194075,137.01014695907,113.032923530859,115.542336569311,105.949918066254,101.190494561142,96.6328209569183,111.567019421622,96.5196637290644,93.2130204394728,101.682928808438,111.560110514136,94.9034034940362,102.036187696162,93.1850318980287,106.881898768837,135.168678734165,120.105758446872,94.6801802604676,189.542335194807,110.604572998741,99.0715152527038,97.5879894810213,187.748803660402,99.6030068183249,128.539238775369,164.857219073915,88.8480896786422,87.2600767332981,205.528232851394,169.815537213165,99.6611039232723,133.022048037621,101.591722263742,94.9625051437182,151.773208334389,243.558636311881,138.806898340086,105.716302763165,175.830577170835,223.415316939183,211.497675236888,168.404123541574,100.236820304487,146.333368144551,132.475603435486,262.521616488804,95.383091866521,89.1284634480974,94.9136794885792,100.772099805419,91.3388894977452,188.666526355654,114.11005927637,205.065843671033,197.776967814635,227.639027565765,187.262471126872,118.780557565283,221.495065549473,176.62173422912,263.144992051378,270.917653406577,100.372899333547,261.337309587438,158.907447637041,169.426908749651,203.266596863942,135.462653599419,147.500997885804,187.480657624991,162.606513634754,192.527510651716,193.92875898077,242.843676966473,123.191130924956,158.401910470432,252.732283578275,119.179991491577,107.494404290594,168.847222748294,115.110376964892,229.202541414831,144.892613683817,167.040643423984,170.444966552917,115.369638424765,101.129692670824,170.260709691633,118.317058432494,170.890944371506,213.442472300195,125.724635269989,223.348346932669,112.966380753693,204.868147777682,108.937497028252,100.528153254582,113.429632353178,186.48545714344,111.367706432555,209.567907303384,295.424424873457,274.412596285015,244.584404510077,236.099086885705,107.801352365049,130.994752578609,92.6652282033958,107.001038417313,110.020939129296,237.151282413889,121.906271384521,121.588737984284,142.740746940898,104.157248047733,103.624852384263,263.473779199643,112.706758738421,122.448345042725,128.633665496851,137.637377953152,87.5032421981799,122.039829623894,125.495100064368,96.5503287470357,96.0783827844535,85.7525068297785,83.1110094046612,93.7797334818616,94.0803498022391,155.275808674193,167.899425999832,190.179589796309,166.236887272779,243.528743287641,121.587681212752,133.095848823631,185.797054812354,84.4729854400398,91.9444716393713,93.740769781718,140.667698172649,203.448620980379,113.53340210821,238.935974992041,142.996068100957,221.789261255543,195.086448178772,154.408732884659,234.699848778055,256.90273870017,104.101737349162,156.188512580221,160.773044223911,232.622717133135,234.405008769932,165.812448327108,114.367812797353,178.610110736819,151.875338517021,235.825476223264,130.076873033712,151.22792712074,109.640204748295,109.447738654507,105.818779559122,137.913425910549,110.797000033211,108.538416898653,125.127244598999,107.307234993722,101.254204083673,109.371136284346,131.803789318372,131.477388833616,128.132091741434,178.171688164273,128.809218021517,245.830306304427,164.656176751056,113.903641505891,178.036310650791,182.594089368708,164.762672293064,179.600515573982,197.711532074979,197.544604337295,206.696465501716,121.851706333148,128.935084149201,169.623322159836,167.68177921726,108.805025895385,279.701787899486,222.964298426711,219.023947792708,224.194002463137,111.049642039737,116.801558590638,117.463500291982,110.532414046918,161.345932916874,126.506756252977,91.9309983181974,142.892900761498,83.5687550693415,79.0794439717812,84.3660791434131,100.037043065167,100.096288396867,78.0201644088899,97.8569451214855,96.1277407091155,94.163549496026,98.1285733545377,101.409976320515,102.687183927311,111.731202630194,115.935243637767,271.361651486583,241.968538644367,152.991179856469,99.3692256457832,91.5422794081926,90.5956235167946,213.622440663549,117.232238406075,112.059351127123,139.309444458608,102.712991170159,83.7993612333242,86.8614722828163,99.9830068367188,84.6609504783695,94.334815661138,80.5036015633504,82.147713110354,184.300775430193,200.822777275623,83.118490090391,113.710486630764,127.224207951284,182.540188096326,163.04471360127,123.697874769905,123.538966053754,153.32134180964,144.104491247727,187.392883441793,187.795304798252,94.3809472632581,112.591290977637,137.439237368045,146.223593289781,81.4667531599402,142.327310849594,212.546961126015,140.317313066938,166.760695489819,124.675975666176,177.203166209856,100.23202249596,101.418370083967,111.794754049488,116.676120822618,147.970947627941,107.203975630558,100.439447447037,125.241942513549,116.155056286822,133.796048281602,103.667309290341,116.173350268369,157.464785683263,129.710307077255,147.281238497144,116.047633425982,107.678887355616,111.813961594418,113.59365849878,118.435952513214,148.88152374285,109.150951371795,103.87020227808,119.268946049751,107.773682728658,111.209119544217,111.076781160448,139.008974390024,113.42274764307,115.670638088069,101.726933850705,142.5218160765,182.693255042947,112.782599026741,113.982436272661,112.543958155933,110.230987053273,105.141959310138,110.547355011143,149.676118040574,104.821286167782,101.772999620366,109.345113180574,117.108020872278,106.666005272493,102.164786119825,156.347493702429,199.067145000963,168.701083298191,113.842365363166,180.847561211633,162.516241783509,172.503953483287,120.002054205263,107.749394174512,144.541542750849,113.635748167916,183.896938184074,161.11404029478,111.588047000318,160.897684610053,175.454476995609,140.138653444804,153.139584134776,180.318198577733,110.075045745379,133.876822918789,111.079931653657,102.177129309673,170.204161591927,111.74246952914,149.535454155815,129.204073154152,106.272918149568,126.599165468649,103.204832396629,105.953310880934,96.0597839658037,111.10448493675,98.3020423407608,109.93713075787,115.865065702212,112.678744646776,112.511639499066,144.696040419727,120.559675414834,135.047201595152,177.845904393374],"x":[197.2,139.06,82.655,85.62,70.415,80.5,63.47,81.635,62.9,125,102.43,105.08,171.94,71.11,87.61,151.67,93.67,184.85,152.78,189.55,164.94,98.135,56.72,67.14,140,51.56,134.71,36.68,243.715,198.33,160.4,170.23,87.63,53.44,253.12,46.28,53.14,43.49,51.13,128.42,102.78,97.14,156.27,85.31,73.43,80.04,174.69,183.45,62.57,239.73,49.57,67.87,237.47,61.2,128.63,111.96,109.1,193.53,157.87,142.38,65.34,158.61,93.61,101.33,72.57,142.92,173.67,270.83,119.42,191.39,77.4,83.57,156.745,58.29,289,216.93,69.88,112.99,109.44,172.87,101.665,113.97,115.5,753.31,142.98,64.475,65.54,147.08,215.03,150,175.86,198.38,143.62,74.12,70,104.72,215,179.06,137.45,54.9,282.64,160.61,111.5,226.565,356.16,143.35,92.96,126.92,164.17,145.96,423.9,179.02,65.08,132.8,161.225,94.97,114.92,113.95,325.53,110.63,165.05,74.415,57.6,112.735,114.86,175,53,103,42.61,160,115.14,103.3,138.75,176.875,225.88,79.6,68.8,93.1,143,132,107.01,69.38,106.33,171.13,91.67,128.17,146,84.17,240.67,51.7,58.45,153.45,115.67,53.17,88.15,65,90.475,33.05,170.39,71.06,57.15,127.97,98.34,108.84,154.015,155.86,75.315,49.56,148.33,123,173.64,114.9,200.75,130.58,87.5,259.25,102.67,79.29,137.92,106.31,191.33,111.455,133.11,84.67,91.27,176.53,147.43,144.32,81.25,88.33,241.81,392.2,106.19,142.54,78.33,228.65,125,250.16,177.49,105,267,248.35,171.94,121.96,84.35,90.19,183.79,116.78,215.65,258.95,129.35,108.33,121.75,136.135,477.27,97.515,125,108.39,114.86,119.725,113.25,210.48,93.55,73.23,177.91,279.24,106.37,171.43,111.265,52,94.015,102.81,120.71,158.86,67.71,55.82,56.25,155.945,165.58,100.29,123.905,226.52,121.11,90.95,200.51,189.075,170.9,208.82,119.24,141.31,89.23,101.69,92.83,150.585,101.39,108.33,103.515,78.66,89.17,100.28,75.83,135,137.17,173.05,70.89,75.84,204.89,88.75,45.83,129.24,188.69,96.26,75.46,97.36,87.97,154,65,116.38,73.78,120.88,82.47,127.31,60.13,148.17,118.51,143.89,102.74,107.99,35.175,69.07,116.29,74.955,128.905,133.33,111.2,142.29,162.78,123.25,100,113.03,56.88,37.04,76.61,104.38,285.99,135,74.31,95.56,67.5,164.165,94.62,62.82,73.48,109.32,130,76.08,381.34,153.75,178.06,122.11,71.67,123.43,54.17,80.75,53.33,125.345,194.92,281.77,141.35,124.75,153.74,143.39,93.285,86,160,238.67,53.29,72.38,112.51,181.99,116.57,100.63,80.83,91.25,82.69,87.475,53.61,98.355,142.5,156.79,80,144.6,124.51,242.26,303.02,106.815,250.79,244.5,119.75,132.06,284.54,175.21,98.88,108.33,109.88,129.58,118.33,105.32,82.21,87.17,61.42,47.62,125,89.44,235.645,82.08,65.955,263.9,32.24,99.69,185.83,94.33,398.78,245.04,158.89,70.3,156.77,121.17,210.82,112.52,80.55,446.06,297.62,136.2,157.58,123.28,134.785,153.22,100,112.65,125.23,99.09,54.86,57.13,241.445,32.21,93.19,94.79,78.91,129,99.14,82,33.61,100.91,109.52,48.32,201.51,121.46,65.21,65,72.92,56.41,76.99,97.66,100,68.83,154.15,203.12,124.61,78.615,131.53,68.96,117,150,160.01,92.59,160.02,129.77,90.36,195.22,141.22,96.55,74.32,91.71,208.29,85.29,109.3,129,119.33,99.42,84.27,76.65,58.73,88.09,136.5,130.18,96.67,190.25,135.91,86.1,129.47,130.51,91.54,56.63,67.4,52.11,92.12,154.88,45.42,99.19,100.82,53.54,55.75,81.5,180.25,137.61,86.94,116.67,325,99.65,124.25,136.36,160.97,100,147.5,138.68,145.315,191.67,108,150,61.06,91.44,56.72,140.95,117.67,70.96,112.14,105.14,260.98,156.19,92.97,84.11,142.03,73.67,152.54,117.29,215,139.05,117.64,108.03,81.49,47.955,126.71,110,112.9,69.34,139.58,95,167.15,246,181.25,149.07,180.25,66.54,106.99,139.1,89.06,76.43,139.39,108.23,74.86,59.39,98.17,174.29,278.11,84.69,122.55,180.67,113.43,133.13,156.25,302.07,165.17,136.25,342.75,228.75,184.815,120,108.33,186.39,114.895,115.84,86.8,163.46,116.94,121.39,97.73,125.27,104.015,83.31,116.165,144,194.98,432.92,482.33,168.41,120.73,102.54,140.2,118.25,80.44,136.21,254.15,113.655,121.67,95.63,53.97,32.605,118.67,174.37,395.44,879.9,375,266.67,483.21,533.61,203.17,116.39,425.995,141.6,481.02,90,143.75,184.47,117.67,90.68,208.66,91.73,151.94,116.04,95.88,113.615,173.1,132.85,98.18,100,176.39,126.25,133.75,115.23,123.59,91.23,87.75,89,136.67,217.5,60.76,74.91,126.81,276.73,114.55,72.585,89.12,84.95,44.48,64.43,149.61,100.83,124.33,128.06,43.18,68.13,105.19,107.38,39.44,201.4,164.79,200.305,81.4,155.15,191.25,163.56,90.06,68.06,139.21,43.33,88.515,201.43,112.5,249.55,62.86,120.55,116.02,129.54,99.6,92.78,99.71,333.34,84.93,87.18,75.56,118.215,189.91,190.35,285.75,203.95,107.14,87.54,58.75,112.96,119.58,51.13,240.41,120,185.27,125,95.96,296.46,194.96,166.67,219.26,293.97,360,259.38,70.9,106.25,116.5,110.96,73.15,98.23,67.5,139,68.19,169.78,148.75,98.6,82.11,154.97,89.78,75.75,45.57,171.61,107.96,56.11,125.775,117.38,116.97,125.365,71.47,260.21,85,75.33,73.83,104.4,120.67,77.12,99.42,101.575,131.46,107.5,113.33,55.96,250.42,155.17,79.63,98.02,97.25,167.475,94.9,42.96,152.6,64.23,110.915,58.25,102.59,89.89,69.48,111.19,169.16,80.33,163.34,52,91.25,103.75,295.73,125.305,145,194.04,133.61,77.095,396.91,235.53,154.59,65.835,119.13,80.88,117.07,155.88,151.41,58.03,200.89,246.75,329.815,150.66,84.71,143,112.32,100,97.92,54.97,80.665,97.5,58.14,104.72,131.01,111.165,181.295,181.05,118.33,87.79,175.5,166.78,314.68,173.17,116.46,218.33,134.38,159.13,214.39,128.37,124.03,146.31,120.25,265.1,184.17,163.92,75.67,236.655,279.83,176.78,70.42,116.33,121.48,141.05,137.78,146.66,215.36,91.825,136.85,129.75,156.54,130,231.02,130,302.92,87.395,188.35,104.55,111.31,78.54,151.38,93.58,191.24,215.71,328.275,256.67,205.22,119.67,118.75,96.92,76.98,55.58,201.38,189.76,97.5,132.17,98.79,65.16,80,104.73,96.915,123.17,156.2,38.47,87.25,160.105,173.55,126.205,106.92,94.55,136.67,74.44,173.41,191.19,160.88,127.67,184.77,94.82,125.03,194.32,67.24,68.7,115.325,118.33,269.78,67.92,126.67,131.2,254.15,126.69,135.56,159.96,220,79.17,340.205,190.13,332.34,121.82,210.6,107.6,187.24,140.19,336.235,87.61,136.49,95.36,77.14,95.86,129.86,66.64,79.82,196.48,62.28,139.84,122.14,139.67,120.92,100.68,247.025,102.635,212.685,190.99,107.67,166.67,139.85,92.005,233.92,145.91,156.875,255.71,150.3,59.46,279.3,111.46,81.455,265,136.56,174.53,310.96,105.43,109.71,78.01,93.52,147.72,102.78,67.33,132.56,62.44,71.03,116.67,74.78,147.985,109.33,120.79,100.07,93.605,64.65,137.44,118.77,144.06,119.675,197.64,256.685,110.84,75.64,52.25,96.47,175,146.88,113.97,200,131.315,50.33,92.71,90.48,92.08,113.49,84.19,76.105,197.98,173,74.46,178.06,159.96,152.5,153.665,128.84,83.19,211.11,138.46,90.61,132.52,99.44,194.52,140.95,149.58,100,213.33,228.03,118.75,188.62,108.5,196.08,74.92,56.68,111.76,88.05,129.02,48.86,50.27,126.81,58.18,188.44,123.86,69.88,94,224.94,142.78,86.67,63.89,58.36,131.35,90.27,187.335,76.64,53.04,143.4,64.29,93.92,167.63,223.04,108.8,90.175,135,148.31,202.75,119.31,100.84,145.14,75.86,51.95,88.37,250,98.83,77.88,93.47,100,49.57,75.63,248,207.65,91.56,81.67,117,178.28,215.23,106.13,74.03,191.07,123.63,118.92,176.11,115.84,218.32,251.13,261.16,161.11,229.05,65.07,241.1,84.88,95.08,225,90.86,300,160,168.33,101.04,131.63,108.29,119.9,73.36,74,89.625,105.055,136.39,98.05,112.515,112.67,86.85,237.39],"mode":"markers","marker":{"color":"black","opacity":0.3},"name":"training set","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"89fc208f3b5.1":{"y":[91.8369489871449,114.64152540815,183.899491634112,114.10754950456,134.87724571625,97.0571510018118,146.747515937929,113.852908241524,111.432358410313,95.9494487048229,106.209876609304,94.5881022347188,120.32730898087,90.6880546523592,231.26005342118,113.288414022893,149.064536546551,110.648881701656,196.672456520183,385.554231554858,349.239306112701,99.6188349493547,180.633110342849,169.655687659857,120.238349105273,120.504304797876,143.192805228698,172.106726239259,97.4926274490467,180.896872919756,101.617596300496,170.875847476453,99.4221195449678,112.197894666573,138.810927908585,236.638837343973,103.670908661165,177.175977967851,94.3273708997229,157.669464824465,255.844833532074,135.668809297584,112.186331263468,268.141962660628,114.343784983701,97.6877726601522,80.2908516219172,81.7077320455407,105.159260844143,116.905989096039,130.177300873273,101.280991554091,123.73104975139,111.808732595753,118.097751290069,173.929922052781,116.57080579398,174.729322092284,109.697444045241,108.020861460716,103.72857537816,121.389093769306,108.709794204382,89.2473945060183,114.094496018554,170.129614214704,103.460261769395,219.864405967309,96.562961630637,114.309027984337,151.788681889425,101.107905699625,97.1382266050997,126.162984739756,147.273466227727,108.787819356061,99.6709600268571,114.332453874545,216.690171803693,95.1488072999206,101.796548494155,121.859815484035,107.866726329038,120.604720211929,157.078654615568,96.9717981277723,94.3325755311182,114.472388504453,136.775077974093,107.080814246567,164.816221813108,98.7988054023677,158.071538346729,188.033741817722,185.812652511202,154.811043226331,166.210664571242,97.4000706157515,139.916251698405,113.704867837368,97.9926440659844,96.0434298303031,95.7133712394333,93.0432329624566,91.5000498272475,89.7706854961987,94.2294935047684,90.308102784772,124.88636530306,104.397864928098,90.8953881396578,113.973095781107,94.8807874862972,137.272992335265,124.455937744114,135.176429190615,124.82933716637,96.795806276093,108.850774055133,142.285552687461,99.4873870394101,99.2523660644091,274.532106260681,185.739163524894,141.853937493902,123.017747752716,98.3437384062743,135.692237706592,127.918681577499,157.153302663523,260.503798700645,139.858550827525,138.465221097121,168.701409304575,111.866287219736,117.509581444245,258.832138835575,283.638465195468,176.205213758987,138.689573592179,110.848072208716,129.434429131307,160.315311888905,111.611518351416,102.839713475114,97.8098214378296,365.706076401651,115.12811484077,106.005196876628,204.903407063165,180.332164887,304.20012059419,90.5483631985469,139.311798712839,129.058528717866,108.544996452369,180.298259422324,85.9522925324099,146.170272615342,217.301369873151,247.911089988421,183.166773206487,95.5067536958677,234.250488291153,89.6296576776761,97.4255498735926,102.173704122457,114.713356059425,125.526153174481,93.5080544877499,153.850205180121,92.1264307507917,98.1804697828058,95.6774993023949,115.733067580419,96.7099118149327,117.032824429695,141.85191637135,110.179637128507,96.4841203589718,133.283990062262,99.5206813511516,181.056286108274,101.98294659547,97.0980078164127,102.442501081621,80.7240961673349,211.657348876994,90.0184768985257,116.997089926403,117.67531678685,149.958587727673,137.828665499909,104.735580351202,220.419773958714,269.011308310245,131.805304609265,108.281901193105,168.647797079002,146.570217854265,162.712466241814,114.442329601794,98.8529185661264,121.334563071416,156.736265757287,145.546828153517,201.981224073718,161.837603156161,102.615806449209,79.5151615594081,178.727477361304,171.07243021289,145.549804391225,120.577989231004,230.061476020234,212.214332414873,81.4825840298805,152.809337270037,93.6973705974735,98.0544564107032,205.726688987741,271.898242866983,313.299667719034,209.218593150632,154.481015594701,259.664253670755,182.897525093314,139.550990499768,200.639920733758,81.1092028272959,103.599931278719,100.290787250798,81.529158468641,97.5417084315976,121.846432165687,183.244664058199,118.206376338524,142.162318760945,109.197555524544,102.777276575848,177.925118827493,99.1022486328919,139.108146218479,140.492732710881,106.010839374146,98.6898636096391,118.52882615371,105.186530909726,117.836794739905,113.910760348949,99.6296326026266,110.93376405894,112.692648107316,203.087324207503,105.061083875004,189.09180193938,134.379566303327,189.084452545675,113.997198647487,120.358798562325,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"x":[111.94,156,320.66,111.32,174.375,64.25,200,175.34,120.94,42.29,98.2,53.3,193.945,87.4,128.33,141.28,145,125.73,127.54,281.09,191.21,50.73,101.39,114,81.94,101.39,128.32,251.46,71.49,197.73,72.885,200.22,162.83,132.15,184.17,192.08,143.92,208,88.54,184.38,265.43,140.94,131.9,241.88,93.89,127.5,51.13,95.42,111.87,87.56,157.38,58.78,146.98,92.43,116.38,243.33,132.5,281.34,84.27,65.04,131.39,108.61,101.11,82.17,117.67,178.33,95.81,403.82,122.15,179.66,122.54,66.32,83.98,150.17,251.25,92.17,76.605,123,150.18,129.17,187.5,112.11,104.855,131.4,124.46,56.42,60.43,127.73,176.44,110.71,118.11,129.89,127.56,250,126.32,129.99,205.56,75.5,97.56,164.53,92.5,60.23,105.46,45.15,101.45,63.26,141.2,112.5,179.81,77.52,123.31,73.37,70.51,108.51,89.35,105.14,236.32,69.62,165.83,124.27,112.64,127.34,291.06,236.58,203.34,122.78,70.29,138.6,115.255,258.21,158,147.56,153.43,125.49,108.34,78.73,168.95,227.94,177.86,143.77,81.67,111.84,134.13,132.57,68.78,75,211.87,136.385,66.33,234.95,151.19,165.975,46.18,205.83,123.335,116.45,65.62,49.78,118.445,117.81,194.03,199.33,88.33,157.44,40.615,108.83,158.17,208.65,180,81.31,160.14,68.63,75.13,73.83,80.73,103.94,89.56,200,204.17,66.94,127.88,68.27,115.83,133.33,91.76,102.52,75.34,230.35,162.68,90.81,129.9,158.56,208.84,53.61,169.08,175,133.64,98.835,152.5,108.3,160.67,114.44,113.94,194.445,214.62,145,113.43,156.31,58.27,129.02,145.86,121.62,203.4,100.675,244.17,173,165.92,207.08,51.78,93.92,290.63,115.92,217.34,224.38,162.76,275.57,277.81,232.07,136.78,57.96,135.49,71.33,73.05,85.86,91.53,69.33,91.85,92.63,90.83,76.28,234.76,73.08,151.3,100.75,89.605,86.32,161.94,115.15,121.84,95.67,134.95,155.67,67.64,143.93,89.21,177.69,158.45,186.33,128.45,50.42,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"mode":"markers","marker":{"color":"red","opacity":0.3},"name":"validation set","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true},"89fc208f3b5.2":{"y":[0,880],"x":[0,880],"mode":"lines","marker":{"color":"black","opacity":0.3},"name":"1:1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"range":[0,510],"title":"predicted (USD)"},"xaxis":{"domain":[0,1],"automargin":true,"range":[0,880],"title":"observed (USD)"},"annotations":[{"x":600,"y":100,"text":"R2 training set: 45 % <br />R2 test set: 40 % <br /> <br />RMSE training set: 54 USD <br />RMSE test set: 57 USD","xref":"x","yref":"y","showarrow":false}],"title":"Income at the segmento level","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"y":[160.596767118734,126.255302146859,115.386230210977,100.156733433431,96.2590364362832,108.720673374269,104.99471321528,105.102018115585,89.9602484982416,99.3338878988703,109.406551846377,102.44508501964,118.852735813648,93.8615376445042,112.547343550218,111.367221523549,98.6318986324381,103.621857471154,116.525586965151,187.205377556329,116.725667826427,98.3468010137114,99.0741683538882,92.5784476623061,111.47735496417,104.766513235616,104.287480059132,97.0509841083531,128.9202356985,130.875941423679,111.39299948511,134.575561028776,97.0327447188443,95.2218133933539,133.355234597176,92.5498619454802,92.2972791016104,91.97797316833,103.575731816203,117.736650158859,101.192990850015,97.7049174563695,109.216743019206,97.5893681376586,91.2518614079524,99.5761786232001,228.343220514777,120.726528115176,91.0174096125785,169.382685469353,98.6918592065605,98.0488287414441,156.3518718949,95.877824447783,156.642307964971,101.636088554147,97.3297486756288,112.219248086636,103.349800884428,120.416652449813,91.212673023318,156.061080838751,96.9147737528253,99.7456730214022,84.0064595940726,105.176940140276,116.6969311106,147.393849147024,115.795575261719,105.724855859829,92.4216510660921,107.090124851298,93.8314676802531,98.6235716476698,181.063386891017,107.474335025641,97.3176059378603,103.283674701128,98.1840406917408,183.949658107069,163.770865039151,99.1925626331388,129.344571155595,263.735866471994,104.275663297275,94.6861826465779,95.3119719731352,148.850939294593,141.798756635708,164.560438803419,181.524928426615,144.47818532378,136.763372633128,114.744883934138,117.423386460437,117.453244357376,150.998806254585,111.072230394812,124.29100976536,104.542530205427,247.373209601251,94.160376034206,107.076233206515,162.981869766208,247.101420342064,151.444068162762,312.597956041754,144.24394502688,216.368299526226,106.891315321832,321.031441920283,205.543743718817,115.282713603748,130.643941912279,119.755671576629,105.627182394262,103.385162703708,130.418737940489,197.516492136903,98.6683279585014,137.750779009335,106.900546355766,107.751834843341,108.160290869421,120.429523982516,132.258322252282,96.9075291482402,114.31133331811,92.3097714645017,132.810728183118,109.372415287862,152.939823627308,154.685973575068,219.748542597274,147.337419243088,159.379643639457,89.3929818206799,147.564158121505,148.641649684716,162.065459782033,197.28190211485,102.337719834767,151.855561673296,128.736192577875,119.053870761874,137.247740327913,153.06542368091,132.132595686259,232.125825857585,93.3281979481863,92.8706563869682,124.201771744007,111.873107844306,94.3967595464083,95.4121014370985,97.6636571907916,95.3934187998226,95.381967723698,165.845567406576,94.154087767225,93.2370491329129,103.712361333487,113.114424848468,99.3172556179095,176.238629803914,122.826661635198,83.9210415651718,95.1030519486318,187.674089733338,143.964668937467,126.619146341772,224.658905249353,164.714981488293,159.666747715093,80.4479411080057,172.437296413237,147.787196638955,114.374897696229,209.191234518795,111.634870359029,205.423933827079,107.0486870524,242.997121376963,118.394576672077,126.519677283063,206.905458830733,149.253785398047,150.428033920764,184.838796143855,161.082029081774,142.070097283061,209.120330529361,130.664167949182,127.020128588098,183.430636165568,176.816672889959,119.534254731335,218.841809209286,140.346142024344,104.688728925107,171.091084395371,173.58924091217,171.566959683287,158.21073614485,99.2977309177127,102.527972055222,219.053926536115,205.043764444077,236.385553768823,204.431923951899,179.524264565722,95.0548871792547,166.601165955312,192.033303449826,263.322245466031,127.291602274969,146.24818549855,172.904597950384,99.927008942623,149.121350256657,173.592884948677,187.897919834677,100.963223496318,105.427529868546,108.168163388325,177.474948144017,138.132012829021,253.336840174083,143.649494649157,80.2920621841093,91.7673404674915,98.5019191665863,105.889418384298,195.456430911794,85.0812662182645,87.8211423903883,98.531868987154,109.137977447574,90.8633162001672,101.679370632402,122.457051489234,132.256165145365,124.952073645899,86.2971998085249,118.575545963561,190.013767566887,94.3503671281795,195.80228007324,146.241128243961,186.477599296501,105.067414723335,99.2235929425775,109.140213839229,155.521384811801,134.997668615585,110.258688739696,106.626474534292,109.08605820726,106.057969384076,124.648408124064,137.642805686805,153.67700479544,156.421578498055,171.552049118862,106.226769978469,110.323957701364,162.284170221097,124.468934113689,105.352982806141,113.39312514796,118.172758991327,156.340072036747,96.1778390981149,107.111177702342,103.295978550924,136.562985112114,108.371450814328,105.675808714374,99.7524599068119,114.888795733074,107.915678975907,108.594757434886,109.193754163064,106.658923927137,108.28040256468,109.985064258753,114.574571692344,98.6298864216477,98.1288226477802,108.185440346085,99.4620345722259,107.588449839408,104.421665637158,126.235956313176,105.892853991997,119.671396382017,119.277122931243,120.764555841968,139.862873480217,98.905590787334,91.9537464996884,91.6106560435073,111.793876467763,128.586505799354,153.574734178023,122.16793485587,107.18059165109,97.6771500749647,103.728230891649,144.172461083383,118.502143540951,99.5943448885549,96.5064380480211,98.3128095683628,168.728775655499,172.122130284429,341.666653388772,109.450267937091,220.67359085726,265.254946154626,115.132098682825,163.986337359429,106.717860503584,108.452232864647,102.290893836669,104.30081826285,158.17235493671,134.398896515332,114.093712461885,100.11912155132,129.838918758627,103.829547727026,111.98015532405,106.716844661155,131.631315544321,151.8094568752,100.957200253909,106.300708588488,99.5991101622557,121.880252381266,104.279218077928,122.636902350447,95.9179688913546,110.465451315123,177.822192070127,92.1406907580817,94.2163027140859,93.2811767947842,186.301610606185,142.549107283326,123.479253206089,120.259684761627,110.67004641499,209.130529293242,140.36170869369,164.077210304422,237.032820373204,231.461725671503,130.89597900279,147.526852864383,205.742179744692,118.833889378908,100.438060420054,101.910571947845,98.0999772166277,112.250367347859,105.181813230186,144.128395419422,96.653293979945,96.5263802506137,121.887482454049,111.409590987336,238.786553887002,103.443554421192,122.636082579094,112.358678835364,92.591578731388,147.497742837664,92.8446533928229,93.4534188722699,147.815188394754,96.4402924957499,194.644623444842,148.99335315926,110.387090736536,87.9587792383236,200.304828547343,98.8910091756283,201.305439910217,121.884455641935,110.320145593096,315.654655916379,271.851392534334,107.530862046892,139.644132729728,168.503854246342,145.212801439785,116.836583847796,124.176573391997,94.1386303074329,94.8462550201626,99.6094156895326,94.5606057641781,95.880792992902,120.58526084358,95.728871703321,125.090602035616,103.008368940738,101.000309036787,102.002530959291,116.629060219839,95.3089264345707,93.2140216989786,107.134470827259,135.628476194396,93.566346841488,133.807095905801,146.180087600606,95.5845167651861,101.074974186471,104.349848404383,99.3556542112748,98.2222596379494,99.9093103008138,111.017998132933,93.2960236018848,126.024352742576,157.413310613656,150.367275518772,95.301952298583,92.8243649718984,93.4913774358635,93.0307523589142,105.274348768905,164.793688152841,93.3789737140662,193.933038409291,98.0811492970946,100.764106671864,193.780109811664,102.236726715198,101.362658411608,96.9434210820107,101.179396888558,143.043537227546,96.8809580851912,121.055925099511,153.023476431157,148.65074293548,102.69612483015,91.9291327367355,97.1236097031364,87.9183369180739,128.212943076105,97.537116772711,112.678056230689,125.492976138052,173.032806864575,157.320902770591,131.35792413317,120.995549028277,95.9391292225123,96.5785092941055,94.6985447317034,93.7608236709517,93.5715649365454,97.2542279422714,111.717761914946,99.1483209505339,92.9560713983874,117.157601704114,91.7240262757473,98.1642656495137,94.838666521993,141.770740414732,115.081279812221,95.3735271040993,104.926347847405,156.345412885693,101.952498987673,119.300325218759,115.338009501424,102.142691866448,158.302558362244,148.128493104484,209.861211363716,149.113499812425,116.74780774145,94.5612455092559,126.453712672824,88.2165040809966,94.2133249945515,95.0088670822385,100.554039779383,89.6917123937191,90.6712050470018,114.953703558276,101.741113916539,157.305899735407,113.22841002521,93.0740421276449,113.717151671104,117.524889305717,116.988206795714,116.744227242856,108.051379343776,147.709314541366,139.811520440382,92.7727335673452,103.107614570614,91.172182126109,79.9496592086679,166.894149441776,97.1307279899404,96.7660112561836,102.465554112745,134.92337659287,145.808824149182,98.966915813299,188.339883394377,166.827461156245,100.334565403186,103.182093460172,99.3343221210392,200.425139937734,124.54430355298,98.454406796611,96.7826457434917,103.08064994423,97.8170346752735,96.8920434123592,101.804526777921,100.098919834646,132.962970570788,154.543890493628,131.622620259753,95.097281990493,122.388554541637,101.201906780725,132.300426757276,119.814993397053,219.495147881834,178.822924732464,208.699036628699,296.398554356406,263.774809708049,127.071175802388,180.478391825065,105.925142384904,128.99352584188,130.542754604101,103.89983269756,103.91370190929,150.736752748982,148.614004776747,129.38619170611,145.839156859695,145.95522964911,105.323746550506,113.276453777686,131.848951461512,136.258443880814,137.474084208582,263.211558627734,212.204969798207,179.639711792699,163.736836418387,137.24341226414,147.113508090941,123.9350325882,100.26281517243,101.584563222923,183.263200614091,94.777409884171,110.245866515708,108.940924540293,99.7264370080746,93.223698722041,113.920642741994,136.916534136236,269.286079561857,256.928344292472,318.574197456865,363.285124208164,300.340729110175,336.3629539976,310.785672878312,130.784191502817,288.56038469546,352.73661003465,227.881699089667,104.145231370018,188.942493705327,217.251677683358,102.805726305713,106.294049255199,185.763765551003,122.915878092237,127.027369602764,116.160497209413,109.890537105237,116.967703361949,124.632425698498,114.106765536748,110.378001366573,192.846190173725,109.241803258169,124.424088183707,170.24198973685,111.545782876171,128.051592057123,112.373156800543,109.157741873502,107.970702601212,103.854266253732,181.060066431241,105.599292810341,110.746154822818,151.707266409964,227.916610523168,110.655493169416,118.428125950981,122.472000170729,105.257467999058,98.3211744436037,97.67195441989,130.035552733458,110.354327945077,123.85074923394,109.593375018176,93.3182073447588,97.7861203392926,98.1956156604486,97.1888583522508,91.3449399227442,136.266164989891,247.853659392805,126.007519982831,101.94790897589,132.358539636309,141.927013427411,116.128825388169,131.824392009375,98.1362289708908,111.159387714731,92.4685050328361,94.2599540922182,122.741339764769,121.958403501559,175.339773218717,106.88446454187,113.129130153499,106.16221933809,93.1054274724864,96.6877687971962,101.485434244562,101.771332809048,145.269195780572,102.892431096209,101.638568221914,98.477239022517,104.774721265934,107.496418038995,141.180791391743,175.122908990255,158.445206056571,106.525106765794,101.026647806536,87.5637898439569,108.066663426395,96.6430044577464,93.0563166456112,152.486355232196,145.977092482758,189.906740710519,192.971380102952,117.122938010551,183.04764010456,218.89887730893,171.322332361092,227.766159731345,266.814109488593,239.865263442316,217.002658941501,106.799596470139,156.672664046868,144.880675273881,93.3259576838161,95.4456831046365,97.5122040270284,95.5231113723746,95.5529010701785,99.4516178253999,180.767084892156,140.687544022066,103.222527396757,109.289100301028,101.947387859787,96.7735830042592,123.922587292743,94.6712866320567,108.24220583623,98.9614827401609,93.1554603801504,110.202075938125,95.0385124995253,94.7252118327074,95.2854942426536,93.4447037530462,102.655406100395,118.252015764889,95.9484730249348,97.5114429067255,97.2545566503545,104.858130870397,95.1232215884615,95.3374697628357,102.06074799813,94.1778661634697,92.861238919192,95.5274283110172,93.8955691194075,137.01014695907,113.032923530859,115.542336569311,105.949918066254,101.190494561142,96.6328209569183,111.567019421622,96.5196637290644,93.2130204394728,101.682928808438,111.560110514136,94.9034034940362,102.036187696162,93.1850318980287,106.881898768837,135.168678734165,120.105758446872,94.6801802604676,189.542335194807,110.604572998741,99.0715152527038,97.5879894810213,187.748803660402,99.6030068183249,128.539238775369,164.857219073915,88.8480896786422,87.2600767332981,205.528232851394,169.815537213165,99.6611039232723,133.022048037621,101.591722263742,94.9625051437182,151.773208334389,243.558636311881,138.806898340086,105.716302763165,175.830577170835,223.415316939183,211.497675236888,168.404123541574,100.236820304487,146.333368144551,132.475603435486,262.521616488804,95.383091866521,89.1284634480974,94.9136794885792,100.772099805419,91.3388894977452,188.666526355654,114.11005927637,205.065843671033,197.776967814635,227.639027565765,187.262471126872,118.780557565283,221.495065549473,176.62173422912,263.144992051378,270.917653406577,100.372899333547,261.337309587438,158.907447637041,169.426908749651,203.266596863942,135.462653599419,147.500997885804,187.480657624991,162.606513634754,192.527510651716,193.92875898077,242.843676966473,123.191130924956,158.401910470432,252.732283578275,119.179991491577,107.494404290594,168.847222748294,115.110376964892,229.202541414831,144.892613683817,167.040643423984,170.444966552917,115.369638424765,101.129692670824,170.260709691633,118.317058432494,170.890944371506,213.442472300195,125.724635269989,223.348346932669,112.966380753693,204.868147777682,108.937497028252,100.528153254582,113.429632353178,186.48545714344,111.367706432555,209.567907303384,295.424424873457,274.412596285015,244.584404510077,236.099086885705,107.801352365049,130.994752578609,92.6652282033958,107.001038417313,110.020939129296,237.151282413889,121.906271384521,121.588737984284,142.740746940898,104.157248047733,103.624852384263,263.473779199643,112.706758738421,122.448345042725,128.633665496851,137.637377953152,87.5032421981799,122.039829623894,125.495100064368,96.5503287470357,96.0783827844535,85.7525068297785,83.1110094046612,93.7797334818616,94.0803498022391,155.275808674193,167.899425999832,190.179589796309,166.236887272779,243.528743287641,121.587681212752,133.095848823631,185.797054812354,84.4729854400398,91.9444716393713,93.740769781718,140.667698172649,203.448620980379,113.53340210821,238.935974992041,142.996068100957,221.789261255543,195.086448178772,154.408732884659,234.699848778055,256.90273870017,104.101737349162,156.188512580221,160.773044223911,232.622717133135,234.405008769932,165.812448327108,114.367812797353,178.610110736819,151.875338517021,235.825476223264,130.076873033712,151.22792712074,109.640204748295,109.447738654507,105.818779559122,137.913425910549,110.797000033211,108.538416898653,125.127244598999,107.307234993722,101.254204083673,109.371136284346,131.803789318372,131.477388833616,128.132091741434,178.171688164273,128.809218021517,245.830306304427,164.656176751056,113.903641505891,178.036310650791,182.594089368708,164.762672293064,179.600515573982,197.711532074979,197.544604337295,206.696465501716,121.851706333148,128.935084149201,169.623322159836,167.68177921726,108.805025895385,279.701787899486,222.964298426711,219.023947792708,224.194002463137,111.049642039737,116.801558590638,117.463500291982,110.532414046918,161.345932916874,126.506756252977,91.9309983181974,142.892900761498,83.5687550693415,79.0794439717812,84.3660791434131,100.037043065167,100.096288396867,78.0201644088899,97.8569451214855,96.1277407091155,94.163549496026,98.1285733545377,101.409976320515,102.687183927311,111.731202630194,115.935243637767,271.361651486583,241.968538644367,152.991179856469,99.3692256457832,91.5422794081926,90.5956235167946,213.622440663549,117.232238406075,112.059351127123,139.309444458608,102.712991170159,83.7993612333242,86.8614722828163,99.9830068367188,84.6609504783695,94.334815661138,80.5036015633504,82.147713110354,184.300775430193,200.822777275623,83.118490090391,113.710486630764,127.224207951284,182.540188096326,163.04471360127,123.697874769905,123.538966053754,153.32134180964,144.104491247727,187.392883441793,187.795304798252,94.3809472632581,112.591290977637,137.439237368045,146.223593289781,81.4667531599402,142.327310849594,212.546961126015,140.317313066938,166.760695489819,124.675975666176,177.203166209856,100.23202249596,101.418370083967,111.794754049488,116.676120822618,147.970947627941,107.203975630558,100.439447447037,125.241942513549,116.155056286822,133.796048281602,103.667309290341,116.173350268369,157.464785683263,129.710307077255,147.281238497144,116.047633425982,107.678887355616,111.813961594418,113.59365849878,118.435952513214,148.88152374285,109.150951371795,103.87020227808,119.268946049751,107.773682728658,111.209119544217,111.076781160448,139.008974390024,113.42274764307,115.670638088069,101.726933850705,142.5218160765,182.693255042947,112.782599026741,113.982436272661,112.543958155933,110.230987053273,105.141959310138,110.547355011143,149.676118040574,104.821286167782,101.772999620366,109.345113180574,117.108020872278,106.666005272493,102.164786119825,156.347493702429,199.067145000963,168.701083298191,113.842365363166,180.847561211633,162.516241783509,172.503953483287,120.002054205263,107.749394174512,144.541542750849,113.635748167916,183.896938184074,161.11404029478,111.588047000318,160.897684610053,175.454476995609,140.138653444804,153.139584134776,180.318198577733,110.075045745379,133.876822918789,111.079931653657,102.177129309673,170.204161591927,111.74246952914,149.535454155815,129.204073154152,106.272918149568,126.599165468649,103.204832396629,105.953310880934,96.0597839658037,111.10448493675,98.3020423407608,109.93713075787,115.865065702212,112.678744646776,112.511639499066,144.696040419727,120.559675414834,135.047201595152,177.845904393374],"x":[197.2,139.06,82.655,85.62,70.415,80.5,63.47,81.635,62.9,125,102.43,105.08,171.94,71.11,87.61,151.67,93.67,184.85,152.78,189.55,164.94,98.135,56.72,67.14,140,51.56,134.71,36.68,243.715,198.33,160.4,170.23,87.63,53.44,253.12,46.28,53.14,43.49,51.13,128.42,102.78,97.14,156.27,85.31,73.43,80.04,174.69,183.45,62.57,239.73,49.57,67.87,237.47,61.2,128.63,111.96,109.1,193.53,157.87,142.38,65.34,158.61,93.61,101.33,72.57,142.92,173.67,270.83,119.42,191.39,77.4,83.57,156.745,58.29,289,216.93,69.88,112.99,109.44,172.87,101.665,113.97,115.5,753.31,142.98,64.475,65.54,147.08,215.03,150,175.86,198.38,143.62,74.12,70,104.72,215,179.06,137.45,54.9,282.64,160.61,111.5,226.565,356.16,143.35,92.96,126.92,164.17,145.96,423.9,179.02,65.08,132.8,161.225,94.97,114.92,113.95,325.53,110.63,165.05,74.415,57.6,112.735,114.86,175,53,103,42.61,160,115.14,103.3,138.75,176.875,225.88,79.6,68.8,93.1,143,132,107.01,69.38,106.33,171.13,91.67,128.17,146,84.17,240.67,51.7,58.45,153.45,115.67,53.17,88.15,65,90.475,33.05,170.39,71.06,57.15,127.97,98.34,108.84,154.015,155.86,75.315,49.56,148.33,123,173.64,114.9,200.75,130.58,87.5,259.25,102.67,79.29,137.92,106.31,191.33,111.455,133.11,84.67,91.27,176.53,147.43,144.32,81.25,88.33,241.81,392.2,106.19,142.54,78.33,228.65,125,250.16,177.49,105,267,248.35,171.94,121.96,84.35,90.19,183.79,116.78,215.65,258.95,129.35,108.33,121.75,136.135,477.27,97.515,125,108.39,114.86,119.725,113.25,210.48,93.55,73.23,177.91,279.24,106.37,171.43,111.265,52,94.015,102.81,120.71,158.86,67.71,55.82,56.25,155.945,165.58,100.29,123.905,226.52,121.11,90.95,200.51,189.075,170.9,208.82,119.24,141.31,89.23,101.69,92.83,150.585,101.39,108.33,103.515,78.66,89.17,100.28,75.83,135,137.17,173.05,70.89,75.84,204.89,88.75,45.83,129.24,188.69,96.26,75.46,97.36,87.97,154,65,116.38,73.78,120.88,82.47,127.31,60.13,148.17,118.51,143.89,102.74,107.99,35.175,69.07,116.29,74.955,128.905,133.33,111.2,142.29,162.78,123.25,100,113.03,56.88,37.04,76.61,104.38,285.99,135,74.31,95.56,67.5,164.165,94.62,62.82,73.48,109.32,130,76.08,381.34,153.75,178.06,122.11,71.67,123.43,54.17,80.75,53.33,125.345,194.92,281.77,141.35,124.75,153.74,143.39,93.285,86,160,238.67,53.29,72.38,112.51,181.99,116.57,100.63,80.83,91.25,82.69,87.475,53.61,98.355,142.5,156.79,80,144.6,124.51,242.26,303.02,106.815,250.79,244.5,119.75,132.06,284.54,175.21,98.88,108.33,109.88,129.58,118.33,105.32,82.21,87.17,61.42,47.62,125,89.44,235.645,82.08,65.955,263.9,32.24,99.69,185.83,94.33,398.78,245.04,158.89,70.3,156.77,121.17,210.82,112.52,80.55,446.06,297.62,136.2,157.58,123.28,134.785,153.22,100,112.65,125.23,99.09,54.86,57.13,241.445,32.21,93.19,94.79,78.91,129,99.14,82,33.61,100.91,109.52,48.32,201.51,121.46,65.21,65,72.92,56.41,76.99,97.66,100,68.83,154.15,203.12,124.61,78.615,131.53,68.96,117,150,160.01,92.59,160.02,129.77,90.36,195.22,141.22,96.55,74.32,91.71,208.29,85.29,109.3,129,119.33,99.42,84.27,76.65,58.73,88.09,136.5,130.18,96.67,190.25,135.91,86.1,129.47,130.51,91.54,56.63,67.4,52.11,92.12,154.88,45.42,99.19,100.82,53.54,55.75,81.5,180.25,137.61,86.94,116.67,325,99.65,124.25,136.36,160.97,100,147.5,138.68,145.315,191.67,108,150,61.06,91.44,56.72,140.95,117.67,70.96,112.14,105.14,260.98,156.19,92.97,84.11,142.03,73.67,152.54,117.29,215,139.05,117.64,108.03,81.49,47.955,126.71,110,112.9,69.34,139.58,95,167.15,246,181.25,149.07,180.25,66.54,106.99,139.1,89.06,76.43,139.39,108.23,74.86,59.39,98.17,174.29,278.11,84.69,122.55,180.67,113.43,133.13,156.25,302.07,165.17,136.25,342.75,228.75,184.815,120,108.33,186.39,114.895,115.84,86.8,163.46,116.94,121.39,97.73,125.27,104.015,83.31,116.165,144,194.98,432.92,482.33,168.41,120.73,102.54,140.2,118.25,80.44,136.21,254.15,113.655,121.67,95.63,53.97,32.605,118.67,174.37,395.44,879.9,375,266.67,483.21,533.61,203.17,116.39,425.995,141.6,481.02,90,143.75,184.47,117.67,90.68,208.66,91.73,151.94,116.04,95.88,113.615,173.1,132.85,98.18,100,176.39,126.25,133.75,115.23,123.59,91.23,87.75,89,136.67,217.5,60.76,74.91,126.81,276.73,114.55,72.585,89.12,84.95,44.48,64.43,149.61,100.83,124.33,128.06,43.18,68.13,105.19,107.38,39.44,201.4,164.79,200.305,81.4,155.15,191.25,163.56,90.06,68.06,139.21,43.33,88.515,201.43,112.5,249.55,62.86,120.55,116.02,129.54,99.6,92.78,99.71,333.34,84.93,87.18,75.56,118.215,189.91,190.35,285.75,203.95,107.14,87.54,58.75,112.96,119.58,51.13,240.41,120,185.27,125,95.96,296.46,194.96,166.67,219.26,293.97,360,259.38,70.9,106.25,116.5,110.96,73.15,98.23,67.5,139,68.19,169.78,148.75,98.6,82.11,154.97,89.78,75.75,45.57,171.61,107.96,56.11,125.775,117.38,116.97,125.365,71.47,260.21,85,75.33,73.83,104.4,120.67,77.12,99.42,101.575,131.46,107.5,113.33,55.96,250.42,155.17,79.63,98.02,97.25,167.475,94.9,42.96,152.6,64.23,110.915,58.25,102.59,89.89,69.48,111.19,169.16,80.33,163.34,52,91.25,103.75,295.73,125.305,145,194.04,133.61,77.095,396.91,235.53,154.59,65.835,119.13,80.88,117.07,155.88,151.41,58.03,200.89,246.75,329.815,150.66,84.71,143,112.32,100,97.92,54.97,80.665,97.5,58.14,104.72,131.01,111.165,181.295,181.05,118.33,87.79,175.5,166.78,314.68,173.17,116.46,218.33,134.38,159.13,214.39,128.37,124.03,146.31,120.25,265.1,184.17,163.92,75.67,236.655,279.83,176.78,70.42,116.33,121.48,141.05,137.78,146.66,215.36,91.825,136.85,129.75,156.54,130,231.02,130,302.92,87.395,188.35,104.55,111.31,78.54,151.38,93.58,191.24,215.71,328.275,256.67,205.22,119.67,118.75,96.92,76.98,55.58,201.38,189.76,97.5,132.17,98.79,65.16,80,104.73,96.915,123.17,156.2,38.47,87.25,160.105,173.55,126.205,106.92,94.55,136.67,74.44,173.41,191.19,160.88,127.67,184.77,94.82,125.03,194.32,67.24,68.7,115.325,118.33,269.78,67.92,126.67,131.2,254.15,126.69,135.56,159.96,220,79.17,340.205,190.13,332.34,121.82,210.6,107.6,187.24,140.19,336.235,87.61,136.49,95.36,77.14,95.86,129.86,66.64,79.82,196.48,62.28,139.84,122.14,139.67,120.92,100.68,247.025,102.635,212.685,190.99,107.67,166.67,139.85,92.005,233.92,145.91,156.875,255.71,150.3,59.46,279.3,111.46,81.455,265,136.56,174.53,310.96,105.43,109.71,78.01,93.52,147.72,102.78,67.33,132.56,62.44,71.03,116.67,74.78,147.985,109.33,120.79,100.07,93.605,64.65,137.44,118.77,144.06,119.675,197.64,256.685,110.84,75.64,52.25,96.47,175,146.88,113.97,200,131.315,50.33,92.71,90.48,92.08,113.49,84.19,76.105,197.98,173,74.46,178.06,159.96,152.5,153.665,128.84,83.19,211.11,138.46,90.61,132.52,99.44,194.52,140.95,149.58,100,213.33,228.03,118.75,188.62,108.5,196.08,74.92,56.68,111.76,88.05,129.02,48.86,50.27,126.81,58.18,188.44,123.86,69.88,94,224.94,142.78,86.67,63.89,58.36,131.35,90.27,187.335,76.64,53.04,143.4,64.29,93.92,167.63,223.04,108.8,90.175,135,148.31,202.75,119.31,100.84,145.14,75.86,51.95,88.37,250,98.83,77.88,93.47,100,49.57,75.63,248,207.65,91.56,81.67,117,178.28,215.23,106.13,74.03,191.07,123.63,118.92,176.11,115.84,218.32,251.13,261.16,161.11,229.05,65.07,241.1,84.88,95.08,225,90.86,300,160,168.33,101.04,131.63,108.29,119.9,73.36,74,89.625,105.055,136.39,98.05,112.515,112.67,86.85,237.39],"mode":"markers","marker":{"color":"black","opacity":0.3,"line":{"color":"rgba(31,119,180,1)"}},"name":"training set","type":"scatter","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[91.8369489871449,114.64152540815,183.899491634112,114.10754950456,134.87724571625,97.0571510018118,146.747515937929,113.852908241524,111.432358410313,95.9494487048229,106.209876609304,94.5881022347188,120.32730898087,90.6880546523592,231.26005342118,113.288414022893,149.064536546551,110.648881701656,196.672456520183,385.554231554858,349.239306112701,99.6188349493547,180.633110342849,169.655687659857,120.238349105273,120.504304797876,143.192805228698,172.106726239259,97.4926274490467,180.896872919756,101.617596300496,170.875847476453,99.4221195449678,112.197894666573,138.810927908585,236.638837343973,103.670908661165,177.175977967851,94.3273708997229,157.669464824465,255.844833532074,135.668809297584,112.186331263468,268.141962660628,114.343784983701,97.6877726601522,80.2908516219172,81.7077320455407,105.159260844143,116.905989096039,130.177300873273,101.280991554091,123.73104975139,111.808732595753,118.097751290069,173.929922052781,116.57080579398,174.729322092284,109.697444045241,108.020861460716,103.72857537816,121.389093769306,108.709794204382,89.2473945060183,114.094496018554,170.129614214704,103.460261769395,219.864405967309,96.562961630637,114.309027984337,151.788681889425,101.107905699625,97.1382266050997,126.162984739756,147.273466227727,108.787819356061,99.6709600268571,114.332453874545,216.690171803693,95.1488072999206,101.796548494155,121.859815484035,107.866726329038,120.604720211929,157.078654615568,96.9717981277723,94.3325755311182,114.472388504453,136.775077974093,107.080814246567,164.816221813108,98.7988054023677,158.071538346729,188.033741817722,185.812652511202,154.811043226331,166.210664571242,97.4000706157515,139.916251698405,113.704867837368,97.9926440659844,96.0434298303031,95.7133712394333,93.0432329624566,91.5000498272475,89.7706854961987,94.2294935047684,90.308102784772,124.88636530306,104.397864928098,90.8953881396578,113.973095781107,94.8807874862972,137.272992335265,124.455937744114,135.176429190615,124.82933716637,96.795806276093,108.850774055133,142.285552687461,99.4873870394101,99.2523660644091,274.532106260681,185.739163524894,141.853937493902,123.017747752716,98.3437384062743,135.692237706592,127.918681577499,157.153302663523,260.503798700645,139.858550827525,138.465221097121,168.701409304575,111.866287219736,117.509581444245,258.832138835575,283.638465195468,176.205213758987,138.689573592179,110.848072208716,129.434429131307,160.315311888905,111.611518351416,102.839713475114,97.8098214378296,365.706076401651,115.12811484077,106.005196876628,204.903407063165,180.332164887,304.20012059419,90.5483631985469,139.311798712839,129.058528717866,108.544996452369,180.298259422324,85.9522925324099,146.170272615342,217.301369873151,247.911089988421,183.166773206487,95.5067536958677,234.250488291153,89.6296576776761,97.4255498735926,102.173704122457,114.713356059425,125.526153174481,93.5080544877499,153.850205180121,92.1264307507917,98.1804697828058,95.6774993023949,115.733067580419,96.7099118149327,117.032824429695,141.85191637135,110.179637128507,96.4841203589718,133.283990062262,99.5206813511516,181.056286108274,101.98294659547,97.0980078164127,102.442501081621,80.7240961673349,211.657348876994,90.0184768985257,116.997089926403,117.67531678685,149.958587727673,137.828665499909,104.735580351202,220.419773958714,269.011308310245,131.805304609265,108.281901193105,168.647797079002,146.570217854265,162.712466241814,114.442329601794,98.8529185661264,121.334563071416,156.736265757287,145.546828153517,201.981224073718,161.837603156161,102.615806449209,79.5151615594081,178.727477361304,171.07243021289,145.549804391225,120.577989231004,230.061476020234,212.214332414873,81.4825840298805,152.809337270037,93.6973705974735,98.0544564107032,205.726688987741,271.898242866983,313.299667719034,209.218593150632,154.481015594701,259.664253670755,182.897525093314,139.550990499768,200.639920733758,81.1092028272959,103.599931278719,100.290787250798,81.529158468641,97.5417084315976,121.846432165687,183.244664058199,118.206376338524,142.162318760945,109.197555524544,102.777276575848,177.925118827493,99.1022486328919,139.108146218479,140.492732710881,106.010839374146,98.6898636096391,118.52882615371,105.186530909726,117.836794739905,113.910760348949,99.6296326026266,110.93376405894,112.692648107316,203.087324207503,105.061083875004,189.09180193938,134.379566303327,189.084452545675,113.997198647487,120.358798562325],"x":[111.94,156,320.66,111.32,174.375,64.25,200,175.34,120.94,42.29,98.2,53.3,193.945,87.4,128.33,141.28,145,125.73,127.54,281.09,191.21,50.73,101.39,114,81.94,101.39,128.32,251.46,71.49,197.73,72.885,200.22,162.83,132.15,184.17,192.08,143.92,208,88.54,184.38,265.43,140.94,131.9,241.88,93.89,127.5,51.13,95.42,111.87,87.56,157.38,58.78,146.98,92.43,116.38,243.33,132.5,281.34,84.27,65.04,131.39,108.61,101.11,82.17,117.67,178.33,95.81,403.82,122.15,179.66,122.54,66.32,83.98,150.17,251.25,92.17,76.605,123,150.18,129.17,187.5,112.11,104.855,131.4,124.46,56.42,60.43,127.73,176.44,110.71,118.11,129.89,127.56,250,126.32,129.99,205.56,75.5,97.56,164.53,92.5,60.23,105.46,45.15,101.45,63.26,141.2,112.5,179.81,77.52,123.31,73.37,70.51,108.51,89.35,105.14,236.32,69.62,165.83,124.27,112.64,127.34,291.06,236.58,203.34,122.78,70.29,138.6,115.255,258.21,158,147.56,153.43,125.49,108.34,78.73,168.95,227.94,177.86,143.77,81.67,111.84,134.13,132.57,68.78,75,211.87,136.385,66.33,234.95,151.19,165.975,46.18,205.83,123.335,116.45,65.62,49.78,118.445,117.81,194.03,199.33,88.33,157.44,40.615,108.83,158.17,208.65,180,81.31,160.14,68.63,75.13,73.83,80.73,103.94,89.56,200,204.17,66.94,127.88,68.27,115.83,133.33,91.76,102.52,75.34,230.35,162.68,90.81,129.9,158.56,208.84,53.61,169.08,175,133.64,98.835,152.5,108.3,160.67,114.44,113.94,194.445,214.62,145,113.43,156.31,58.27,129.02,145.86,121.62,203.4,100.675,244.17,173,165.92,207.08,51.78,93.92,290.63,115.92,217.34,224.38,162.76,275.57,277.81,232.07,136.78,57.96,135.49,71.33,73.05,85.86,91.53,69.33,91.85,92.63,90.83,76.28,234.76,73.08,151.3,100.75,89.605,86.32,161.94,115.15,121.84,95.67,134.95,155.67,67.64,143.93,89.21,177.69,158.45,186.33,128.45,50.42],"mode":"markers","marker":{"color":"red","opacity":0.3,"line":{"color":"rgba(255,127,14,1)"}},"name":"validation set","type":"scatter","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[0,880],"x":[0,880],"mode":"lines+markers","marker":{"color":"black","opacity":0.3,"line":{"color":"rgba(44,160,44,1)"}},"name":"1:1","type":"scatter","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
<p class="caption">
Figure 7.1: Observed vs predicted income values, BYM 2 model with covariates selected with the backward stepwise selection process
</p>
</div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Processor: Intel(R) Core(TM) i7-7700HQ CPU @ 2.80GHz, 16.0 GB RAM<a href="stepwise.html#fnref1">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summary-of-resuls.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["SV_mapping.pdf", "SV_mapping.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
